---
layout: page
title: "Developing Web Applications with Haskell and Yesod"
prev: OEBPS/ch13s03.html
next: OEBPS/ch13s05.html
book_path: books/michael-snoyman-developing-web-applications-with-haskell-and-yesod-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="book" title="Example: Request Information"><div class="book"><div class="book"><div class="book"><h1 class="title2"><a id="I_sect12_d1e6892" class="calibre1"></a>Example: Request Information</h1></div></div></div><p class="calibre7"></p><p class="calibre7">Likewise, you can get request information inside a <code class="literal">Widget</code>. Here we
            can determine the sort order of a list based on a GET parameter.</p><a id="I_programlisting2_d1e6901" class="firstname"></a><pre class="programlistinghaskell"><code class="cm">{-# LANGUAGE OverloadedStrings, TypeFamilies, TemplateHaskell,</code>
<code class="cm">             QuasiQuotes, TypeFamilies, MultiParamTypeClasses, GADTs #-}</code>
<code class="kr">import</code> <code class="nn">Yesod</code>
<code class="kr">import</code> <code class="nn">Data.Text</code> <code class="p">(</code><code class="kt">Text</code><code class="p">)</code>
<code class="kr">import</code> <code class="nn">Data.List</code> <code class="p">(</code><code class="nf">sortBy</code><code class="p">)</code>
<code class="kr">import</code> <code class="nn">Data.Ord</code> <code class="p">(</code><code class="nf">comparing</code><code class="p">)</code>

<code class="kr">data</code> <code class="kt">Person</code> <code class="ow">=</code> <code class="kt">Person</code>
    <code class="p">{</code> <code class="n">personName</code> <code class="ow">::</code> <code class="kt">Text</code>
    <code class="p">,</code> <code class="n">personAge</code> <code class="ow">::</code> <code class="kt">Int</code>
    <code class="p">}</code>

<code class="nf">people</code> <code class="ow">::</code> <code class="p">[</code><code class="kt">Person</code><code class="p">]</code>
<code class="nf">people</code> <code class="ow">=</code>
    <code class="p">[</code> <code class="kt">Person</code> <code class="s">"Miriam"</code> <code class="mi">25</code>
    <code class="p">,</code> <code class="kt">Person</code> <code class="s">"Eliezer"</code> <code class="mi">3</code>
    <code class="p">,</code> <code class="kt">Person</code> <code class="s">"Michael"</code> <code class="mi">26</code>
    <code class="p">,</code> <code class="kt">Person</code> <code class="s">"Gavriella"</code> <code class="mi">1</code>
    <code class="p">]</code>

<code class="kr">data</code> <code class="kt">People</code> <code class="ow">=</code> <code class="kt">People</code>

<code class="nf">mkYesod</code> <code class="s">"People"</code> <code class="p">[</code><code class="n">parseRoutes</code><code class="o">|</code>
<code class="o">/</code> <code class="kt">RootR</code> <code class="kt">GET</code>
<code class="o">|</code><code class="p">]</code>

<code class="kr">instance</code> <code class="kt">Yesod</code> <code class="kt">People</code>

<code class="kr">instance</code> <code class="kt">RenderMessage</code> <code class="kt">People</code> <code class="kt">FormMessage</code> <code class="kr">where</code>
    <code class="n">renderMessage</code> <code class="kr">_</code> <code class="kr">_</code> <code class="ow">=</code> <code class="n">defaultFormMessage</code>


<code class="nf">getRootR</code> <code class="ow">::</code> <code class="kt">Handler</code> <code class="kt">RepHtml</code>
<code class="nf">getRootR</code> <code class="ow">=</code> <code class="n">defaultLayout</code> <code class="p">[</code><code class="n">whamlet</code><code class="o">|</code>
<code class="o">&lt;</code><code class="n">p</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="n">a</code> <code class="n">href</code><code class="ow">=</code><code class="s">"?sort=name"</code><code class="o">&gt;</code><code class="kt">Sort</code> <code class="n">by</code> <code class="n">name</code>
    <code class="nf">\</code> <code class="o">|</code> <code class="o">#</code>
    <code class="o">&lt;</code><code class="n">a</code> <code class="n">href</code><code class="ow">=</code><code class="s">"?sort=age"</code><code class="o">&gt;</code><code class="kt">Sort</code> <code class="n">by</code> <code class="n">age</code>
    <code class="nf">\</code> <code class="o">|</code> <code class="o">#</code>
    <code class="o">&lt;</code><code class="n">a</code> <code class="n">href</code><code class="ow">=</code><code class="s">"?"</code><code class="o">&gt;</code><code class="kt">No</code> <code class="n">sort</code>
<code class="o">^</code><code class="p">{</code><code class="n">showPeople</code><code class="p">}</code>
<code class="o">|</code><code class="p">]</code>

<code class="nf">showPeople</code> <code class="ow">::</code> <code class="kt">Widget</code>
<code class="nf">showPeople</code> <code class="ow">=</code> <code class="kr">do</code>
    <code class="n">msort</code> <code class="ow">&lt;-</code> <code class="n">lift</code> <code class="o">$</code> <code class="n">runInputGet</code> <code class="o">$</code> <code class="n">iopt</code> <code class="n">textField</code> <code class="s">"sort"</code>
    <code class="kr">let</code> <code class="n">people'</code> <code class="ow">=</code>
            <code class="kr">case</code> <code class="n">msort</code> <code class="kr">of</code>
                <code class="kt">Just</code> <code class="s">"name"</code> <code class="ow">-&gt;</code> <code class="n">sortBy</code> <code class="p">(</code><code class="n">comparing</code> <code class="n">personName</code><code class="p">)</code> <code class="n">people</code>
                <code class="kt">Just</code> <code class="s">"age"</code>  <code class="ow">-&gt;</code> <code class="n">sortBy</code> <code class="p">(</code><code class="n">comparing</code> <code class="n">personAge</code><code class="p">)</code>  <code class="n">people</code>
                <code class="kr">_</code>           <code class="ow">-&gt;</code> <code class="n">people</code>
    <code class="p">[</code><code class="n">whamlet</code><code class="o">|</code>
<code class="o">&lt;</code><code class="n">dl</code><code class="o">&gt;</code>
    <code class="o">$</code><code class="n">forall</code> <code class="n">person</code> <code class="ow">&lt;-</code> <code class="n">people'</code>
        <code class="o">&lt;</code><code class="n">dt</code><code class="o">&gt;#</code><code class="p">{</code><code class="n">personName</code> <code class="n">person</code><code class="p">}</code>
        <code class="o">&lt;</code><code class="n">dd</code><code class="o">&gt;#</code><code class="p">{</code><code class="n">show</code> <code class="o">$</code> <code class="n">personAge</code> <code class="n">person</code><code class="p">}</code>
<code class="o">|</code><code class="p">]</code>

<code class="nf">main</code> <code class="ow">::</code> <code class="kt">IO</code> <code class="nb">()</code>
<code class="nf">main</code> <code class="ow">=</code> <code class="n">warpDebug</code> <code class="mi">3000</code> <code class="kt">People</code>
</pre><p class="calibre7">Once again, all we need to do is <code class="literal">lift</code> our normal
                <code class="literal">Handler</code> code (in this case, <code class="literal">runInputGet</code>) to have
            it run in our <code class="literal">Widget</code>.</p></div></div>

{% endraw %}

