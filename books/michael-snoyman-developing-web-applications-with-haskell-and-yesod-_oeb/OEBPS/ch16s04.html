---
layout: page
title: "Developing Web Applications with Haskell and Yesod"
prev: OEBPS/ch16s03.html
next: OEBPS/ch16s05.html
book_path: books/michael-snoyman-developing-web-applications-with-haskell-and-yesod-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="book" title="RenderMessage Typeclass"><div class="book"><div class="book"><div class="book"><h1 class="title2"><a id="I_sect15_d1e8019" class="calibre1"></a>RenderMessage Typeclass</h1></div></div></div><p class="calibre7"></p><p class="calibre7">Your call to <code class="literal">mkMessage</code> creates an instance of the
    <code class="literal">RenderMessage</code> typeclass, which is the core of Yesod’s i18n. It is defined
   as:</p><a id="I_programlisting5_d1e8031" class="firstname"></a><pre class="programlistinghaskell"><code class="kr">class</code> <code class="kt">RenderMessage</code> <code class="n">master</code> <code class="n">message</code> <code class="kr">where</code>
    <code class="n">renderMessage</code> <code class="ow">::</code> <code class="n">master</code>
                  <code class="ow">-&gt;</code> <code class="p">[</code><code class="kt">Text</code><code class="p">]</code> <code class="cm">-- ^ languages</code>
                  <code class="ow">-&gt;</code> <code class="n">message</code>
                  <code class="ow">-&gt;</code> <code class="kt">Text</code>
</pre><p class="calibre7">Notice that there are two parameters to the <code class="literal">RenderMessage</code> class: the
   master site and the message type. In theory, we could skip the master type here, but that would
   mean that every site would need to have the same set of translations for each message type. When
   it comes to shared libraries like forms, that would not be a workable solution.</p><p class="calibre7">The <code class="literal">renderMessage</code> function takes a parameter for each of the class’s
   type parameters: master and message. The extra parameter is a list of languages the user will
   accept, in descending order of priority. The method then returns a user-ready
    <code class="literal">Text</code> that can be displayed.</p><p class="calibre7">A simple instance of <code class="literal">RenderMessage</code> may involve no actual translation
   of strings; instead, it will just display the same value for every language. For example:</p><a id="I_programlisting5_d1e8051" class="firstname"></a><pre class="programlistinghaskell"><code class="kr">data</code> <code class="kt">MyMessage</code> <code class="ow">=</code> <code class="kt">Hello</code> <code class="o">|</code> <code class="kt">Greet</code> <code class="kt">Text</code>
<code class="kr">instance</code> <code class="kt">RenderMessage</code> <code class="kt">MyApp</code> <code class="kt">MyMessage</code> <code class="kr">where</code>
    <code class="n">renderMessage</code> <code class="kr">_</code> <code class="kr">_</code> <code class="kt">Hello</code> <code class="ow">=</code> <code class="s">"Hello"</code>
    <code class="n">renderMessage</code> <code class="kr">_</code> <code class="kr">_</code> <code class="p">(</code><code class="kt">Greet</code> <code class="n">name</code><code class="p">)</code> <code class="ow">=</code> <code class="s">"Welcome, "</code> <code class="o">&lt;&gt;</code> <code class="n">name</code> <code class="o">&lt;&gt;</code> <code class="s">"!"</code>
</pre><p class="calibre7">Notice how we ignore the first two parameters to <code class="literal">renderMessage</code>. We
   can now extend this to support multiple languages:</p><a id="I_programlisting5_d1e8058" class="firstname"></a><pre class="programlistinghaskell"><code class="nf">renderEn</code> <code class="kt">Hello</code> <code class="ow">=</code> <code class="s">"Hello"</code>
<code class="nf">renderEn</code> <code class="p">(</code><code class="kt">Greet</code> <code class="n">name</code><code class="p">)</code> <code class="ow">=</code> <code class="s">"Welcome, "</code> <code class="o">&lt;&gt;</code> <code class="n">name</code> <code class="o">&lt;&gt;</code> <code class="s">"!"</code>
<code class="nf">renderHe</code> <code class="kt">Hello</code> <code class="ow">=</code> <code class="s">"שלום"</code>
<code class="nf">renderHe</code> <code class="p">(</code><code class="kt">Greet</code> <code class="n">name</code><code class="p">)</code> <code class="ow">=</code> <code class="s">"ברוכים הבאים, "</code> <code class="o">&lt;&gt;</code> <code class="n">name</code> <code class="o">&lt;&gt;</code> <code class="s">"!"</code>
<code class="kr">instance</code> <code class="kt">RenderMessage</code> <code class="kt">MyApp</code> <code class="kt">MyMessage</code> <code class="kr">where</code>
    <code class="n">renderMessage</code> <code class="kr">_</code> <code class="p">(</code><code class="s">"en"</code><code class="kt">:</code><code class="kr">_</code><code class="p">)</code> <code class="ow">=</code> <code class="n">renderEn</code>
    <code class="n">renderMessage</code> <code class="kr">_</code> <code class="p">(</code><code class="s">"he"</code><code class="kt">:</code><code class="kr">_</code><code class="p">)</code> <code class="ow">=</code> <code class="n">renderHe</code>
    <code class="n">renderMessage</code> <code class="n">master</code> <code class="p">(</code><code class="kr">_</code><code class="kt">:</code><code class="n">langs</code><code class="p">)</code> <code class="ow">=</code> <code class="n">renderMessage</code> <code class="n">master</code> <code class="n">langs</code>
    <code class="n">renderMessage</code> <code class="kr">_</code> <code class="kt">[]</code> <code class="ow">=</code> <code class="n">renderEn</code>
</pre><p class="calibre7">The idea here is fairly straightforward: we define helper functions to support each
      language. We then add a clause to catch each of those languages in the renderMessage
      definition. We then have two final cases: if no languages matched, continue checking with the
      next language in the user’s priority list. If we’ve exhausted all languages the user
      specified, then use the default language (in our case, English).</p><p class="calibre7">But odds are that you will never need to worry about writing this stuff manually, as the
   message file interface does all this for you. But it’s always a good idea to have an
   understanding of what’s going on under the surface.</p></div></div>

{% endraw %}

