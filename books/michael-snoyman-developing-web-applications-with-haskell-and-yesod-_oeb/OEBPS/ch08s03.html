---
layout: page
title: "Developing Web Applications with Haskell and Yesod"
prev: OEBPS/ch08s02.html
next: OEBPS/ch08s04.html
book_path: books/michael-snoyman-developing-web-applications-with-haskell-and-yesod-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="book" title="Types"><div class="book"><div class="book"><div class="book"><h1 class="title2"><a id="I_sect18_d1e3794" class="calibre1"></a>Types</h1></div></div></div><p class="calibre7">The <code class="function">Yesod.Form.Types</code> module declares a few types.
      Let’s start off with some simple helpers:</p><div class="book"><dl class="book"><dt class="calibre9"><span class="firstname">Enctype</span></dt><dd class="calibre10"><p class="calibre7">The encoding type, either <code class="literal">UrlEncoded</code> or <code class="literal">Multipart</code>. This data type declares an instance of <code class="literal">ToHtml</code>, so you can use the enctype directly in
            Hamlet.</p></dd><dt class="calibre9"><span class="firstname">Env</span></dt><dd class="calibre10"><p class="calibre7">Maps a parameter name to a list of values.</p></dd><dt class="calibre9"><span class="firstname">FileEnv</span></dt><dd class="calibre10"><p class="calibre7">Maps a parameter name to the associated uploaded file.</p></dd><dt class="calibre9"><span class="firstname">Ints</span></dt><dd class="calibre10"><p class="calibre7">As mentioned in the introduction, <code class="literal">yesod-form</code> automatically assigns
     a unique name to each field. <code class="literal">Ints</code> is used to keep track of the next number to
     assign.</p></dd><dt class="calibre9"><span class="firstname">FormResult</span></dt><dd class="calibre10"><p class="calibre7">Has one of three possible states: <code class="literal">FormMissing</code> if no data was
     submitted, <code class="literal">FormFailure</code> if there was an error parsing the form (e.g., missing a
     required field, invalid content), or <code class="literal">FormSuccess</code> if everything went
     smoothly.</p></dd></dl></div><p class="calibre7">Next we have three data types used for defining individual fields.</p><div class="tip" title="Note"><h3 class="title3">Note</h3><p class="calibre7">A field is a single piece of information, such as a number, a string, or an email
        address. Fields are combined together to build forms.</p></div><div class="book"><dl class="book"><dt class="calibre9"><span class="firstname">Field</span></dt><dd class="calibre10"><p class="calibre7">Defines two pieces of functionality: how to parse the text input from a user into a
     Haskell value, and how to create the widget to be displayed to the user.
      <code class="literal">yesod-form</code> defines a number of individual Fields in <code class="function">Yesod.Form.Fields</code>.</p></dd><dt class="calibre9"><span class="firstname">FieldSettings</span></dt><dd class="calibre10"><p class="calibre7">Basic information on how a field should be displayed, such as the display name, an
     optional tooltip, and possibly hardcoded <code class="literal">id</code> and <code class="literal">name</code>
     attributes. (If none are provided, they are automatically generated.)</p><div class="tip" title="Note"><h3 class="title3">Note</h3><p class="calibre7"><code class="literal">FieldSettings</code> provides an <code class="literal">IsString</code> instance, so when you need to provide a <code class="literal">FieldSettings</code> value, you can actually type in a literal
                string. That’s how we interacted with it in the synopsis.</p></div></dd><dt class="calibre9"><span class="firstname">FieldView</span></dt><dd class="calibre10"><p class="calibre7">An intermediate format containing a bunch of view information on a field. This is
            hardly ever used directly by the user, we’ll see more details later.</p></dd></dl></div><p class="calibre7">And finally, we get to the important stuff: the forms themselves. There are three types
      for this: <code class="literal">MForm</code> is for monadic forms, <code class="literal">AForm</code> for applicative, and <code class="literal">IForm</code> (declared in <code class="function">IForm</code>) for input.
        <code class="literal">MForm</code> is actually a type synonym for a monad stack that
      provides the following features:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><p class="calibre7">A <code class="literal">Reader</code> monad giving us the parameters (<code class="literal">Env</code> and
     <code class="literal">FileEnv</code>), the master site argument and the list of languages the user
    supports. The last two are used for i18n (more on this later).</p></li><li class="listitem"><p class="calibre7">A <code class="literal">Writer</code> monad keeping track of the <code class="literal">Enctype</code>. A
    form will always be <code class="literal">UrlEncoded</code>, unless there is a file input field, which will
    force us to use multipart instead.</p></li><li class="listitem"><p class="calibre7">A <code class="literal">State</code> monad holding an <code class="literal">Ints</code> to keep track of the
    next unique name to produce.</p></li></ul></div><p class="calibre7">An <code class="literal">AForm</code> is pretty similar. However, there are a few major
   differences:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><p class="calibre7">It produces a list of <code class="literal">FieldViews</code>. This allows us to keep an
    abstract idea of the form display, and then at the end of the day choose an appropriate function
    for laying it out on the page. In the synopsis, we used <code class="literal">renderDivs</code>, which
    creates a bunch of div tags. Another option would be <code class="literal">renderTable</code>.</p></li><li class="listitem"><p class="calibre7">It does not provide a <code class="literal">Monad</code> instance. The goal of
     <code class="literal">Applicative</code> is to allow the entire form to run, grab as much information on
    each field as possible, and then create the final result. This cannot work in the context of
     <code class="literal">Monad</code>.</p></li></ul></div><p class="calibre7">An <code class="literal">IForm</code> is even simpler: it returns either a list of error messages
   or a result.</p></div></div>

{% endraw %}

