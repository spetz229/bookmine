---
layout: page
title: "Unknown"
prev: r26943.htm
next: r27151.htm
book_path: books/o-reilly-practical-postgresql_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="NAVHEADER"><table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0" class="calibre"><tr class="calibre1"><th colspan="3" class="calibre2">Practical PostgreSQL</th></tr><tr class="calibre1"><td width="10%" valign="bottom" class="calibre3"><a href="r26943.htm" accesskey="P">Prev</a></td><td width="80%" valign="bottom" class="calibre4"/><td width="10%" valign="bottom" class="calibre5"><a href="r27151.htm" accesskey="N">Next</a></td></tr></table><hr width="100%" class="calibre6"/></div><h1 class="calibre7"><a name="SQL-FETCH" class="calibre8">FETCH</a></h1><div class="NAVHEADER"><a name="AEN27012"></a><h2 class="SECT">Name</h2>FETCH -- Retrieves rows from a cursor.</div><div class="NAVHEADER"><a name="AEN27015"></a><h2 class="SECT">Synopsis</h2><pre class="SCREEN">FETCH <tt class="REPLACEABLE"><i class="EMPHASIS">direction</i></tt>
      [ <tt class="REPLACEABLE"><i class="EMPHASIS">count</i></tt> ] { IN | FROM } <tt class="REPLACEABLE"><i class="EMPHASIS">cursor</i></tt>
<tt class="REPLACEABLE"><i class="EMPHASIS">direction</i></tt> ::= { FORWARD | BACKWARD | RELATIVE }
<tt class="REPLACEABLE"><i class="EMPHASIS">count</i></tt> ::= { <tt class="REPLACEABLE"><i class="EMPHASIS">numrows</i></tt> | ALL | NEXT | PRIOR }</pre><div class="NAVHEADER"><a name="R2-SQL-FETCH-1"></a><h3 class="AUTHOR">Parameters</h3><p class="calibre9">
</p><p class="calibre9"></p><div class="NAVHEADER"><dl class="calibre9"><dt class="NAVHEADER"><tt class="REPLACEABLE"><i class="EMPHASIS">direction</i></tt></dt><dd class="calibre16"><p class="calibre9">Use the optional <tt class="REPLACEABLE"><i class="EMPHASIS">direction</i></tt> parameter to specify the direction you want to fetch.  It may be specified as any of the following keywords:</p><p class="calibre9"> </p><p class="calibre9"></p><div class="NAVHEADER"><dl class="calibre17"><dt class="NAVHEADER"><tt class="REPLACEABLE">FORWARD</tt></dt><dd class="calibre16"><p class="calibre9">The keyword used to retrieve rows following the current position. This is the default, if the <tt class="REPLACEABLE"><i class="EMPHASIS">direction</i></tt> is not explicitly set.</p></dd><dt class="NAVHEADER"><tt class="REPLACEABLE">BACKWARD</tt></dt><dd class="calibre16"><p class="calibre9">The keyword used to retrieve rows preceding the current position.</p></dd><dt class="NAVHEADER"><tt class="REPLACEABLE">RELATIVE</tt></dt><dd class="calibre16"><p class="calibre9">A noise term made available for SQL92 compatibility. As of PostgreSQL 7.1.x, all cursors locate rows relative to the current cursor position, and this keyword therefore has no effect. Note that combining the <tt class="REPLACEABLE">RELATIVE</tt> keyword with a <tt class="REPLACEABLE">count</tt> of 0 will produce an error (see the "Results" section later in this reference entry).</p></dd></dl></div>
</dd><dt class="NAVHEADER"><tt class="REPLACEABLE"><i class="EMPHASIS">count</i></tt></dt><dd class="calibre16"><p class="calibre9">          This parameter takes the number of rows you wish to fetch.  You can specify an integer constant here to have a specific
          number of rows fetched (<tt class="REPLACEABLE"><i class="EMPHASIS">numrows</i></tt>), or use any of the following keywords:
        </p><a name="AEN27059"></a><blockquote class="NOTE"><p class="calibre9"></p></blockquote><p class="calibre9"> </p><p class="calibre9"></p><div class="NAVHEADER"><dl class="calibre17"><dt class="NAVHEADER"><tt class="REPLACEABLE">ALL</tt></dt><dd class="calibre16"><p class="calibre9">The keyword used to retrieve all rows.</p></dd><dt class="NAVHEADER"><tt class="REPLACEABLE">NEXT</tt></dt><dd class="calibre16"><p class="calibre9">The keyword used to retrieve the row immediately following the current position.</p></dd><dt class="NAVHEADER"><tt class="REPLACEABLE">PRIOR</tt></dt><dd class="calibre16"><p class="calibre9">The keyword used to retrieve the row immediately preceding the current position.</p></dd></dl></div>
</dd><dt class="NAVHEADER"><tt class="REPLACEABLE"><i class="EMPHASIS">cursor</i></tt></dt><dd class="calibre16"><p class="calibre9">The name of an open cursor you wish to use for the <tt class="REPLACEABLE">FETCH</tt>.</p></dd></dl></div>
</div><div class="NAVHEADER"><a name="R2-SQL-FETCH-2"></a><h3 class="AUTHOR">Results</h3><p class="calibre9">A successful <tt class="REPLACEABLE">FETCH</tt> command returns any query results generated by the specified cursor. If the query fails, one of the following messages will be displayed:
        </p><a name="AEN27088"></a><blockquote class="NOTE"><p class="calibre9"></p></blockquote><p class="calibre9"> </p><p class="calibre9"></p><div class="NAVHEADER"><dl class="calibre9"><dt class="NAVHEADER"><tt class="REPLACEABLE">NOTICE:  PerformPortalFetch: portal "</tt><tt class="REPLACEABLE"><i class="EMPHASIS">cursor</i></tt><tt class="REPLACEABLE">" not found</tt></dt><dd class="calibre16"><p class="calibre9">The notice returned if the specified cursor has not yet been declared. Remember that you must declare a cursor within a transaction block before it can be used.</p></dd><dt class="NAVHEADER"><tt class="REPLACEABLE">NOTICE:  FETCH/ABSOLUTE not supported, using RELATIVE</tt></dt><dd class="calibre16"><p class="calibre9">The notice returned if you attempt to use absolute positioning with the <tt class="REPLACEABLE">ABSOLUTE</tt> keyword in place of the <tt class="REPLACEABLE">RELATIVE</tt> keyword. PostgreSQL does not currently support absolute positioning of cursors (which would move a cursor to a specific row offset in a result set, rather than a row relative to the current cursor position).</p></dd><dt class="NAVHEADER"><tt class="REPLACEABLE">ERROR:  FETCH/RELATIVE at current position is not supported</tt></dt><dd class="calibre16"><p class="calibre9">The error returned if you attempt to pass 0 as the number of rows to fetch, with the <tt class="REPLACEABLE">RELATIVE</tt> direction specified.  This happens because the <tt class="REPLACEABLE">FETCH RELATIVE 0 FROM cursor</tt> syntax is defined within SQL92 as allowing a user to continually retrieve the row which is at the cursor's current position.</p><p class="calibre9">PostgreSQL does not support the use of this syntax; used without the <tt class="REPLACEABLE">RELATIVE</tt> keyword, instead of returning the current position's row, the use of 0 indicates to the database that you wish to retrieve <span><i class="EMPHASIS">all</i></span> rows. Used with the <tt class="REPLACEABLE">RELATIVE</tt> keyword, however, PostgreSQL assumes you are instead trying to use the SQL92 defined functionality and displays this error instead of fetching all rows.</p></dd></dl></div>
</div></div><div class="NAVHEADER"><a name="R1-SQL-FETCH-1"></a><h2 class="SECT">Description</h2><p class="calibre9">Use the <tt class="REPLACEABLE">FETCH</tt> command to retrieve a specified number of rows using a cursor.  You always need to be within a transaction while using cursors, as the data they store is not independent of other users within the system.  The number of rows you specify can be either positive or negative.  A positive number will fetch from whatever direction you specify with the direction parameter (if you don't specify a direction, <tt class="REPLACEABLE">FORWARD</tt> will be used by default).</p><p class="calibre9">A negative number will take you in the opposite direction as that specified by the <tt class="REPLACEABLE"><i class="EMPHASIS">direction</i></tt> parameter. For example, specifying <tt class="REPLACEABLE">FORWARD -5</tt> has the same effect as specifying <tt class="REPLACEABLE">BACKWARD 5</tt>.  If the number of rows you specify is greater than the number of rows remaining to be retrieved, the <tt class="REPLACEABLE">FETCH</tt> command will return all those remaining.</p><div class="NAVHEADER"><blockquote class="NOTE"><p class="calibre9"><b class="calibre10">Note: </b>As of PostgreSQL 7.1.x, you cannot update data using a cursor.</p><a name="AEN27129"></a><blockquote class="NOTE"><p class="calibre9"></p></blockquote></blockquote></div></div><div class="NAVHEADER"><a name="R1-SQL-FETCH-2"></a><h2 class="SECT">Examples</h2><p class="calibre9">The following examples assume a transaction and an already-defined cursor (named <tt class="REPLACEABLE">cur_employee</tt>) that returns rows from the <tt class="REPLACEABLE">employees</tt> table.</p><p class="calibre9">The following example fetches the first two rows in the <tt class="REPLACEABLE">cur_employee</tt> cursor:</p><pre class="SCREEN">booktown=# <tt class="REPLACEABLE"><b class="calibre10">BEGIN;</b></tt>
BEGIN
booktown=# <tt class="REPLACEABLE"><b class="calibre10">DECLARE cur_employee CURSOR FOR</b></tt>
booktown-# <tt class="REPLACEABLE"><b class="calibre10">        SELECT first_name, last_name FROM employees;</b></tt>
SELECT
booktown=# <tt class="REPLACEABLE"><b class="calibre10">FETCH FORWARD 2 IN cur_employee;</b></tt>
 first_name | last_name
------------+-----------
 Vincent    | Appel
 Michael    | Holloway
(2 rows)</pre><p class="calibre9">The following example uses <tt class="REPLACEABLE">BACKWARD -2</tt> (a double negative) to then fetch two rows in the forward direction:</p><pre class="SCREEN">booktown=# <tt class="REPLACEABLE"><b class="calibre10">FETCH BACKWARD -2 IN cur_employee;</b></tt>
 first_name | last_name
------------+-----------
 David      | Joble
 Ben        | Noble
(2 rows)</pre><p class="calibre9">The next example demonstrates how to actually fetch backwards in the <tt class="REPLACEABLE">cur_employee</tt> cursor:</p><pre class="SCREEN">booktown=# <tt class="REPLACEABLE"><b class="calibre10">FETCH BACKWARD 3 IN cur_employee;</b></tt>
 first_name | last_name
------------+-----------
 David      | Joble
 Michael    | Holloway
 Vincent    | Appel
(3 rows)</pre></div><div class="NAVHEADER"><hr width="100%" class="calibre6"/><table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0" class="calibre"><tr class="calibre1"><td width="33%" valign="top" class="calibre3"><a href="r26943.htm" accesskey="P">Prev</a></td><td width="34%" valign="top" class="calibre4"><a href="book1.htm" accesskey="H">Home</a></td><td width="33%" valign="top" class="calibre5"><a href="r27151.htm" accesskey="N">Next</a></td></tr><tr class="calibre1"><td width="33%" valign="top" class="calibre3">EXPLAIN</td><td width="34%" valign="top" class="calibre4"><a href="c22759.htm" accesskey="U">Up</a></td><td width="33%" valign="top" class="calibre5">GRANT</td></tr></table></div></div>

{% endraw %}

