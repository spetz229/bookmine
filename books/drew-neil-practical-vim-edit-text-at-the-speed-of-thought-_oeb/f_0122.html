---
layout: page
title: "Practical Vim (for Kathryn Amaral)"
prev: f_0121.html
next: f_0123.html
book_path: books/drew-neil-practical-vim-edit-text-at-the-speed-of-thought-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>


<table class="arr-recipe" id="N1952E">
<tr class="calibre14">
<td class="arr-recipe-number">Tip 87</td>
<td class="arr-recipe-name">Meet the Substitute Command</td>
</tr>
</table>
<p id="N19534" class="calibre4">
<span class="calibre5">
        The <code class="cf">:substitute</code> command is complex: in addition to providing a search pattern and replacement string, we have to specify the range over which it will execute. Optionally, we can also provide flags to tweak its behavior.
    </span>
</p>
<p id="N19543" class="calibre4">
      The substitute command allows us to find and replace one chunk of text with another. The command’s syntax looks like this:
    </p>
<table class="processedcode">
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​:[range]s[ubstitute]/{pattern}/{string}/[flags]​</code>​</div>
</td>
</tr>
</table>
<p id="N19555" class="calibre4">
      The substitute command has many parts to it. The rules for the <code class="cf">[range]</code> are just the same as for every other Ex command, which we covered in-depth in <a xmlns:str="http://exslt.org/strings" href="f_0050.html#sec.ex.address">Tip 28</a>. As for the <code class="cf">{pattern}</code>, that was covered in <a xmlns:str="http://exslt.org/strings" href="f_0104.html#chp.patterns">Chapter 12, ​<em class="calibre5">Matching Patterns and Literals</em>​</a>.
    </p>
<h3 class="calibre22">Tweak the Substitute Command Using Flags</h3>
<p id="N1956B" class="calibre4">
        We can tweak the behavior of the substitute command using flags. The best way to understand what a flag does is to see it in action, so let’s  briefly define a handful of flags that are used in other tips. (For a complete reference, look up <strong xmlns:str="http://exslt.org/strings" class="calibre10">:s_flags</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/change.html#:s_flags">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>.)
      </p>
<p id="N1957A" class="calibre4">
        The <code class="cf">g</code> flag makes the substitute command act <span class="calibre5">globally</span>, causing it to change all matches within a line rather than just changing the first one. We’ll meet it in <a xmlns:str="http://exslt.org/strings" href="f_0123.html#sec.substitute.global">Tip 88</a>.
      </p>
<p id="N19596" class="calibre4">
        The <code class="cf">c</code> flag gives us the opportunity to <span class="calibre5">confirm</span> or reject each change. We’ll see it in action in <a xmlns:str="http://exslt.org/strings" href="f_0124.html#sec.substitute.confirm">Tip 89</a>.
      </p>
<p id="N195AF" class="calibre4">
        The <code class="cf">n</code> flag suppresses the usual substitute behavior, causing the command to report the <span class="calibre5">number</span> of occurrences that would be affected if we ran the substitute command. <a xmlns:str="http://exslt.org/strings" href="f_0116.html#sec.count.matches">Tip 82</a>, gives an example of usage.
      </p>
<p id="N195C3" class="calibre4">
        If we run the substitute command using a pattern that has no matches in the current file, Vim will report an error saying “E486: Pattern not found.” We can silence these errors by including the <code class="cf">e</code> flag, as we’ll see in <a xmlns:str="http://exslt.org/strings" href="f_0131.html#sec.substitute.in.project">Tip 96</a>.
      </p>
<p id="N195D0" class="calibre4">
        The <code class="cf">&amp;</code> flag simply tells Vim to reuse the same flags from the previous substitute command. <a xmlns:str="http://exslt.org/strings" href="f_0127.html#sec.substitute.repeat">Tip 92</a>, shows a scenario where it comes in handy.
      </p>
<h3 class="calibre22">Special Characters for the Replacement String</h3>
<p id="N195E5" class="calibre4">
        In <a xmlns:str="http://exslt.org/strings" href="f_0104.html#chp.patterns">Chapter 12, ​<em class="calibre5">Matching Patterns and Literals</em>​</a>, we saw that some characters take on special meaning when used in search patterns. The replacement field also has a handful of special characters. You can find the complete list by looking up <strong xmlns:str="http://exslt.org/strings" class="calibre10">sub-replace-special</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/change.html#sub-replace-special">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>, but some of the highlights are summarized in this table:
      </p>
<table class="simpletable">
<thead class="calibre23">
<tr class="calibre7">
<th class="hlines">Symbol</th>
<th class="hlines">Represents</th>
</tr>
</thead>
<tbody class="calibre6">
<tr class="calibre7">
<td class="calibre24">
<p class="last-para-in-cell">
<code class="cf">\r</code>
</p>
</td>
<td class="calibre24">
<p class="last-para-in-cell">
		  Insert a carriage return</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">\t</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">
		  Insert a tab character</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">\\</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">
		  Insert a single backslash</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">\1</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">Insert the first submatch</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">\2</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">Insert the second submatch (and so on, up to <code class="cf">\9</code>)</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">\0</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">Insert the entire matched pattern</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">&amp;</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">Insert the entire matched pattern</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">~</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">Use {string} from the previous invocation of <code class="cf">:substitute</code>
</p>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<code class="cf">\={Vim script}</code>
</p>
</td>
<td class="calibre26">
<p class="last-para-in-cell">Evaluate {Vim script} expression; use result as replacement {string}</p>
</td>
</tr>
</tbody>
</table>
<p id="N1967B" class="calibre4">
        The <code class="cf">\r</code>, <code class="cf">\t</code> and <code class="cf">\\</code> tokens should be fairly self-explanatory. In <a xmlns:str="http://exslt.org/strings" href="f_0127.html#sec.substitute.repeat">Tip 92</a>, we’ll see how the <code class="cf">~</code> token works, but we’ll also learn about a couple of shortcuts that make it even faster to repeat a substitute command. We’ll see <code class="cf">\1</code> and <code class="cf">\2</code> in use in <a xmlns:str="http://exslt.org/strings" href="f_0128.html#sec.substitute.capture">Tip 93</a>.
      </p>
<p id="N19698" class="calibre4">
        The <code class="cf">\={Vim script}</code> token is very powerful. It allows us to execute code and use the result as our replacement <code class="cf">{string}</code>. In <a xmlns:str="http://exslt.org/strings" href="f_0129.html#sec.substitute.arithmetic">Tip 94</a>, and <a xmlns:str="http://exslt.org/strings" href="f_0130.html#sec.substitute.swap">Tip 95</a>, we’ll see a couple of examples of usage.
		</p>
<script src="scripts/book_local.js" type="text/javascript" class="calibre2"/>
</div>

{% endraw %}

