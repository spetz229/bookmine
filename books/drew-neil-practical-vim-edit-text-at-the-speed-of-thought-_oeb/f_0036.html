---
layout: page
title: "Practical Vim (for Kathryn Amaral)"
prev: f_0035.html
next: f_0037.html
book_path: books/drew-neil-practical-vim-edit-text-at-the-speed-of-thought-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>


<table class="arr-recipe" id="sec.insert.expression">
<tr class="calibre14">
<td class="arr-recipe-number">Tip 16</td>
<td class="arr-recipe-name">Do Back-of-the-Envelope Calculations in Place</td>
</tr>
</table>
<p id="N11AAE" class="calibre4">
<span class="calibre5">
        The expression register allows us to perform calculations and then insert the result directly into our document. In this tip, we’ll see one application for this powerful feature.
    </span>
</p>
<p id="N11ACA" class="calibre4">
      Most of Vim’s registers contain text either as a string of characters or as entire lines of text. The delete and yank commands allow us to set the contents of a register, while the put command allows us to get the contents of a register by inserting it into the document.
    </p>
<p id="N11AD6" class="calibre4">
      The expression register is different. It can evaluate a piece of Vim script code and return the result. Here, we can use it like a calculator. Passing it a simple arithmetic expression, such as <code class="cf">1+1</code>, gives a result of <code class="cf">2</code>. We can use the return value from the expression register just as though it were a piece of text saved in a plain old register.
    </p>
<p id="N11ADF" class="calibre4">
      The expression register is addressed by the <code class="cf">=</code> symbol. From Insert mode we can access it by typing <span class="calibre17">&lt;C-r&gt;=</span>. This opens a prompt at the bottom of the screen where we can type the expression that we want to evaluate. When done, we hit <span class="calibre17">&lt;CR&gt;</span>, and Vim inserts the result at our current position in the document.
    </p>
<p id="N11AEB" class="calibre4">
      Suppose that we’ve just typed the following:
    </p>
<table class="processedcode">
<tr class="calibre28">
<td colspan="2" class="calibre33">
<a href="http://media.pragprog.com/titles/dnvim/code/insert_mode/back-of-envelope.txt">insert_mode/back-of-envelope.txt</a>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​6 chairs, each costing $35, totals $​</code>​</div>
</td>
</tr>
</table>
<p id="N11AFB" class="calibre4">
      There’s no need to scribble on the back side of an envelope. Vim can do the math for us, and we don’t even have to leave Insert mode. Here’s how:
    </p>
<table class="simpletable">
<thead class="calibre23">
<tr class="calibre7">
<th class="hlines">Keystrokes</th>
<th class="hlines">Buffer Contents</th>
</tr>
</thead>
<tbody class="calibre6">
<tr class="calibre7">
<td class="calibre24">
<p class="last-para-in-cell">
<span class="calibre17">A</span>
</p>
</td>
<td class="calibre24">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix1" valign="top">
<span> </span>
</td>
<td class="codeline1" valign="top">
<div class="calibre32">
​<code class="calibre30">​6 chairs, each costing $35, totals $<span class="shade-fg-white"> </span>​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<span class="calibre17">&lt;C-r&gt;=</span>
<code class="cf">6*35</code>
<span class="calibre17">&lt;CR&gt;</span>
</p>
</td>
<td class="calibre26">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​6 chairs, each costing $35, totals $210<span class="shade-fg-white"> </span>​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
<p id="N11B37" class="calibre4">
      The expression register is capable of much more than simple arithmetic. We’ll meet a slightly more advanced example in <a xmlns:str="http://exslt.org/strings" href="f_0101.html#sec.macro.increment">Tip 70</a>.
    </p>
<script src="scripts/book_local.js" type="text/javascript" class="calibre2"/>
</div>

{% endraw %}

