---
layout: page
title: "Practical Vim (for Kathryn Amaral)"
prev: f_0043.html
next: f_0045.html
book_path: books/drew-neil-practical-vim-edit-text-at-the-speed-of-thought-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>


<table class="arr-recipe" id="sec.prefer.operators">
<tr class="calibre14">
<td class="arr-recipe-number">Tip 23</td>
<td class="arr-recipe-name">Prefer Operators to Visual Commands Where Possible</td>
</tr>
</table>
<p id="N120D7" class="calibre4">
<span class="calibre5">
        Visual mode may be more intuitive than Vim’s Normal mode of operation, but it has a weakness: it doesn’t always play well with the dot command. We can route around this weakness by using Normal mode operators when appropriate.
    </span>
</p>
<p id="N120E9" class="calibre4">
      Suppose that we want to transform the following list of links to make them shout:
    </p>
<table class="processedcode">
<tr class="calibre28">
<td colspan="2" class="calibre33">
<a href="http://media.pragprog.com/titles/dnvim/code/visual_mode/list-of-links.html">visual_mode/list-of-links.html</a>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">&lt;a</strong> href=<em class="string">"#"</em>
<strong class="prompt">&gt;</strong>one<strong class="prompt">&lt;/a&gt;</strong>​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">&lt;a</strong> href=<em class="string">"#"</em>
<strong class="prompt">&gt;</strong>two<strong class="prompt">&lt;/a&gt;</strong>​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">&lt;a</strong> href=<em class="string">"#"</em>
<strong class="prompt">&gt;</strong>three<strong class="prompt">&lt;/a&gt;</strong>​</code>​</div>
</td>
</tr>
</table>
<p id="N1211A" class="calibre4">
      We can select the inner contents of a tag by running <span class="calibre17">vit</span>, which can be read as: <span class="calibre5">visually</span> select <span class="calibre5">inside</span> the <span class="calibre5">tag</span>. The <span class="calibre17">it</span> command is a special kind of motion called a text object, which we’ll cover in detail in <a xmlns:str="http://exslt.org/strings" href="f_0078.html#sec.text.objects">Tip 51</a>.
    </p>
<h3 class="calibre22">Using a Visual Operator</h3>
<p id="N12134" class="calibre4">
        In Visual mode, we make a selection and then act on it. In this case, we could use the <span class="calibre17">U</span> command, which converts the selected characters to uppercase (<strong xmlns:str="http://exslt.org/strings" class="calibre10">v_U</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/change.html#v_U">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>). See <a xmlns:str="http://exslt.org/strings" href="#table.uppercasing">Table 4, ​<em class="calibre5">Uppercasing in Visual Mode</em>​</a>.
      </p>
<hr class="calibre37"/>
<div class="figurecaption" id="table.uppercasing">Table 4. Uppercasing in Visual Mode</div>
<table class="simpletable">
<thead class="calibre23">
<tr class="calibre7">
<th class="hlines">Keystrokes</th>
<th class="hlines">Buffer Contents</th>
</tr>
</thead>
<tbody class="calibre6">
<tr class="calibre7">
<td class="calibre24">
<p class="last-para-in-cell">
<code class="cf">{start}</code>
</p>
</td>
<td class="calibre24">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix1" valign="top">
<span> </span>
</td>
<td class="codeline1" valign="top">
<div class="calibre32">
​<code class="calibre30">​<span class="shade-fg-white">&lt;</span>a href="#"&gt;one&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix1" valign="top">
<span> </span>
</td>
<td class="codeline1" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;two&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix1" valign="top">
<span> </span>
</td>
<td class="codeline1" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;three&lt;/a&gt;​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<span class="calibre17">vit</span>
</p>
</td>
<td class="calibre26">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;<span class="shade-fg-black">on<span class="shade-fg-white">e</span>
</span>&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;two&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;three&lt;/a&gt;​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<span class="calibre17">U</span>
</p>
</td>
<td class="calibre26">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;<span class="shade-fg-white">O</span>NE&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;two&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;three&lt;/a&gt;​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
<hr class="calibre37"/>
<p id="N121B7" class="calibre4">
      Having transformed the first line, we now want to perform the same change on the next two lines. How about we try using the Dot Formula?
    </p>
<p id="N121BF" class="calibre4">
      Running <span class="calibre17">j.</span> advances our cursor to the next line and then repeats the last change. It works fine on line two, but if we try it again we end up with this strange-looking result:
    </p>
<table class="processedcode">
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">&lt;a</strong> href=<em class="string">"#"</em>
<strong class="prompt">&gt;</strong>ONE<strong class="prompt">&lt;/a&gt;</strong>​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">&lt;a</strong> href=<em class="string">"#"</em>
<strong class="prompt">&gt;</strong>TWO<strong class="prompt">&lt;/a&gt;</strong>​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">&lt;a</strong> href=<em class="string">"#"</em>
<strong class="prompt">&gt;</strong>THRee<strong class="prompt">&lt;/a&gt;</strong>​</code>​</div>
</td>
</tr>
</table>
<p id="N121F2" class="calibre4">
      Do you see what’s happened? When a Visual mode command is repeated, it affects the same range of text (see <strong xmlns:str="http://exslt.org/strings" class="calibre10">visual-repeat</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/visual.html#visual-repeat">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>). In this case, the original command affected a word consisting of three letters. This works fine for line two, which happens to also contain a three-letter word, but it falls short when we try to repeat the command on a word containing five letters.
    </p>
<h3 class="calibre22">Using a Normal Operator</h3>
<p id="N121FD" class="calibre4">
      The Visual mode <span class="calibre17">U</span> command has a Normal mode equivalent: <span class="calibre17">gU{motion}</span> (<strong xmlns:str="http://exslt.org/strings" class="calibre10">gU</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/change.html#gU">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>). If we use this to make the first change, we can complete the subsequent edits using the Dot Formula as shown in <a xmlns:str="http://exslt.org/strings" href="#table.normal-operator">Table 5, ​<em class="calibre5">Normal Operator in Visual Mode</em>​</a>.
    </p>
<hr class="calibre37"/>
<div class="figurecaption" id="table.normal-operator">Table 5. Normal Operator in Visual Mode</div>
<table class="simpletable">
<thead class="calibre23">
<tr class="calibre7">
<th class="hlines">Keystrokes</th>
<th class="hlines">Buffer Contents</th>
</tr>
</thead>
<tbody class="calibre6">
<tr class="calibre7">
<td class="calibre24">
<p class="last-para-in-cell">
<code class="cf">{start}</code>
</p>
</td>
<td class="calibre24">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix1" valign="top">
<span> </span>
</td>
<td class="codeline1" valign="top">
<div class="calibre32">
​<code class="calibre30">​<span class="shade-fg-white">&lt;</span>a href="#"&gt;one&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix1" valign="top">
<span> </span>
</td>
<td class="codeline1" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;two&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix1" valign="top">
<span> </span>
</td>
<td class="codeline1" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;three&lt;/a&gt;​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<span class="calibre17">gUit</span>
</p>
</td>
<td class="calibre26">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;<span class="shade-fg-white">O</span>NE&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;two&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;three&lt;/a&gt;​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<span class="calibre17">j.</span>
</p>
</td>
<td class="calibre26">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;ONE&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;<span class="shade-fg-white">T</span>WO&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;three&lt;/a&gt;​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
<tr class="calibre7">
<td class="calibre26">
<p class="last-para-in-cell">
<span class="calibre17">j.</span>
</p>
</td>
<td class="calibre26">
<table class="processedcode1">
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;ONE&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;TWO&lt;/a&gt;​</code>​</div>
</td>
</tr>
<tr class="calibre31">
<td class="codeprefix2" valign="top">
<span> </span>
</td>
<td class="codeline2" valign="top">
<div class="calibre32">
​<code class="calibre30">​&lt;a href="#"&gt;<span class="shade-fg-white">T</span>HREE&lt;/a&gt;​</code>​</div>
</td>
</tr>
</table>
</td>
</tr>
</tbody>
</table>
<hr class="calibre37"/>
<h3 class="calibre22">Discussion</h3>
<p id="N12296" class="calibre4">
      Both of these techniques require only four keystrokes: <span class="calibre17">vitU</span> versus <span class="calibre17">gUit</span>, but the underlying semantics are quite different. In the Visual mode approach, the four keystrokes can be considered as two separate commands: <span class="calibre17">vit</span> to make a selection and <span class="calibre17">U</span> to transform the selection. In contrast, <span class="calibre17">gUit</span> can be considered as a single command comprised of an operator (<span class="calibre17">gU</span>) and a motion (<span class="calibre17">it</span>).
    </p>
<p id="N122AE" class="calibre4">
      If we want to set up the dot command so that it repeats something useful, then we’re better off staying out of Visual mode. As a general rule, we should prefer operator commands over their Visual mode equivalents when working through a repetitive set of changes.
    </p>
<p id="N122B1" class="calibre4">
      That’s not to say that Visual mode is out of bounds. It still has a place. Not every editing task needs to be repeated, so Visual mode is perfectly adequate for one-off changes. And even though Vim’s motions allow for surgical precision, sometimes we need to modify a range of text whose structure is difficult to trace. In these cases, Visual mode is the right tool for the job.
    </p>
<script src="scripts/book_local.js" type="text/javascript" class="calibre2"/>
</div>

{% endraw %}

