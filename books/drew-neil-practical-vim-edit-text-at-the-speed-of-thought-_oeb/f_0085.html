---
layout: page
title: "Practical Vim (for Kathryn Amaral)"
prev: f_0084.html
next: f_0086.html
book_path: books/drew-neil-practical-vim-edit-text-at-the-speed-of-thought-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>


<table class="arr-recipe" id="sec.gf">
<tr class="calibre14">
<td class="arr-recipe-number">Tip 57</td>
<td class="arr-recipe-name">Jump to the Filename Under the Cursor</td>
</tr>
</table>
<p id="N15FF2" class="calibre4">
<span class="calibre5">
        Vim treats filenames in our document as a kind of hyperlink. When configured properly, we can use the <span class="calibre17">gf</span> command to go to the filename under the cursor.
	</span>
      
      As a demonstration, we’ll use the <code class="cf">jumps</code> directory, which you can find in the source files that come distributed with this book. It contains the following directory tree:
    </p>
<table class="processedcode" id="code.gf.tree">
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​practical_vim.rb​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​practical_vim/​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​  core.rb​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​  jumps.rb​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​  more.rb​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​  motions.rb​</code>​</div>
</td>
</tr>
</table>
<p id="N1602F" class="calibre4">
      In the shell, we’ll start by changing to the <code class="cf">jumps</code> directory and then launching Vim. For this demonstration, I recommend using the <code class="cf">-u NONE -N</code> flags to ensure that Vim starts up without loading any plugins:
    </p>
<table class="processedcode">
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span>=&gt; </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">$ cd code/jumps</strong>​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span>=&gt; </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">$ vim -u NONE -N practical_vim.rb</strong>​</code>​</div>
</td>
</tr>
</table>
<p id="N1604A" class="calibre4">
      The <code class="cf">practical_vim.rb</code> file does nothing more than load the contents of the <code class="cf">core.rb</code> and <code class="cf">more.rb</code> files:
    </p>
<table class="processedcode">
<tr class="calibre28">
<td colspan="2" class="calibre33">
<a href="http://media.pragprog.com/titles/dnvim/code/jumps/practical_vim.rb">jumps/practical_vim.rb</a>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​require <em class="string">'practical_vim/core'</em>​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span> </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​require <em class="string">'practical_vim/more'</em>​</code>​</div>
</td>
</tr>
</table>
<p id="N1606A" class="calibre4">
      Wouldn’t it be useful if we could quickly inspect the contents of the file specified by the <code class="cf">require</code> directive? That’s what Vim’s <span class="calibre17">gf</span> command is for. Think of it as <span class="calibre5">go to file</span> (<strong xmlns:str="http://exslt.org/strings" class="calibre10">gf</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/editing.html#gf">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>).
    </p>
<p id="N1607A" class="calibre4">
      Let’s try it out. We’ll start by placing our cursor somewhere inside the <code class="cf">’practical_vim/core’</code> string (for example, pressing <span class="calibre17">fp</span> would get us there quickly). If we try using the <span class="calibre17">gf</span> command now, we get this error: “E447: Can’t find file ‘practical_vim/core’ in path.”
    </p>
<p id="N16086" class="calibre4">
      Vim tries to open a file called <code class="cf">practical_vim/core</code> and reports that it doesn’t exist, but there is a file called <code class="cf">practical_vim/core.rb</code> (note the file extension). Somehow we need to instruct Vim to modify the filepath under the cursor by appending the <code class="cf">rb</code> file extension before attempting to open it. We can do this with the <code class="cf">‘suffixesadd’</code> option.
    </p>
<h3 class="calibre22">Specify a File Extension</h3>
<p id="N1609F" class="calibre4">
        The <code class="cf">‘suffixesadd’</code> option allows us to specify one or more file extensions, which Vim will attempt to use when looking up a filename with the <span class="calibre17">gf</span> command  (<strong xmlns:str="http://exslt.org/strings" class="calibre10">'suffixesadd'</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/options.html#'suffixesadd'">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>). We can set it up by running this command:
      </p>
<table class="processedcode">
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span>=&gt; </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">:set suffixesadd+=.rb</strong>​</code>​</div>
</td>
</tr>
</table>
<p id="N160C1" class="calibre4">
        Now when we use the <span class="calibre17">gf</span> command, Vim jumps directly to the filepath under the cursor. Try using it to open <code class="cf">more.rb</code>. In that file, you’ll find a couple of other <code class="cf">require</code> declarations. Pick one, and open it up using the <span class="calibre17">gf</span> command.
      </p>
<p id="N160D0" class="calibre4">
        Each time we use the <span class="calibre17">gf</span> command, Vim adds a record to the jump list, so we can always go back to where we came from using the <span class="calibre17">&lt;C-o&gt;</span> command (see <a xmlns:str="http://exslt.org/strings" href="f_0083.html#sec.jump.list">Tip 55</a>). In this case, pressing <span class="calibre17">&lt;C-o&gt;</span> the first time would take us back to <code class="cf">more.rb</code>, and pressing it a second time would take us back to <code class="cf">practical_vim.rb</code>.
      </p>
<h3 class="calibre22">Specify the Directories to Look Inside</h3>
<p id="N160F0" class="calibre4">
        In this example, each of the files referenced with the <code class="cf">require</code> statement was located relative to the working directory. But what if we referenced functionality that was provided by a third-party library, such as a rubygem?
      </p>
<p id="N160FB" class="calibre4">
        That’s where the <code class="cf">‘path’</code> option comes in (<strong xmlns:str="http://exslt.org/strings" class="calibre10">'path'</strong>
<a xmlns:str="http://exslt.org/strings" href="http://vimdoc.sourceforge.net/htmldoc/options.html#'path'">
<img alt="info" src="images/information.png" class="calibre21"/>​</a>). We can configure this to reference a comma-separated list of directories. When we use the <span class="calibre17">gf</span> command, Vim checks each of the directories listed in <code class="cf">‘path’</code> to see if it contains a filename that matches the text under the cursor. The <code class="cf">‘path’</code> setting is also used by the <code class="cf">:find</code> command, which we covered in <a xmlns:str="http://exslt.org/strings" href="f_0067.html#sec.find.command">Tip 42</a>.
      </p>
<p id="N1611B" class="calibre4">
        We can inspect the value of the path by running this command:
      </p>
<table class="processedcode">
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span>=&gt; </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​<strong class="prompt">:set path?</strong>​</code>​</div>
</td>
</tr>
<tr class="calibre28">
<td class="codeprefix" valign="top">
<span>&lt;= </span>
</td>
<td class="codeline" valign="top">
<div class="calibre29">
​<code class="calibre30">​path=.,/usr/include,,​</code>​</div>
</td>
</tr>
</table>
<p id="N1612F" class="calibre4">
        In this context, the <code class="cf">.</code> stands for the directory of the current file, whereas the empty string (delimited by two adjacent commas) stands for the working directory. The default settings work fine for this simple example, but for a larger project we would want to configure the <code class="cf">‘path’</code> setting to include a few more directories.
      </p>
<p id="N1613D" class="calibre4">
        For example, it would be useful if the <code class="cf">‘path’</code> included the directories for all rubygems used in a Ruby project. Then we could use the <span class="calibre17">gf</span> command to open up the modules referenced by any <code class="cf">require</code> statements. For an automated solution, check out Tim Pope’s bundler.vim plugin,<a id="FNPTR-17" href="f_0086.html#FOOTNOTE-17">[17]</a> which uses the project <code class="cf">Gemfile</code> to populate the <code class="cf">‘path’</code> setting.
      </p>
<h3 class="calibre22">Discussion</h3>
<p id="N1615F" class="calibre4">
        In the setup for this tip, I recommended launching Vim with plugins disabled. That’s because Vim is usually distributed with a Ruby file-type plugin, which handles the setup of <code class="cf">‘suffixesadd’</code> and <code class="cf">‘path’</code> options for us. If you do a lot of work with Ruby, I recommend getting the latest version of the file-type plugin from github because it’s actively maintained.<a id="FNPTR-18" href="f_0086.html#FOOTNOTE-18">[18]</a>
</p>
<p id="N16176" class="calibre4">
        The <code class="cf">‘suffixesadd’</code> and <code class="cf">‘path’</code> options can be set locally for each buffer, so they can be configured in different ways for different file types. Vim is distributed with file-type plugins for many other languages besides Ruby, so in practice you won’t often have to set these options yourself. Even so, it’s worth understanding how the <span class="calibre17">gf</span> command works. It makes each filepath in our document behave like a hyperlink, which makes it easier to navigate through a codebase.
      </p>
<p id="N1618E" class="calibre4">
        The <span class="calibre17">&lt;C-]&gt;</span> command has a similar role. It also requires a bit of setup (as discussed in <a xmlns:str="http://exslt.org/strings" href="f_0140.html#sec.ctags.configure">Tip 102</a>), but when it’s correctly configured, it allows us to jump from any method invocation directly to the place where it was defined. Skip ahead to <a xmlns:str="http://exslt.org/strings" href="f_0141.html#sec.ctags.navigation">Tip 103</a>, for a demonstration.
      </p>
<p id="N161A1" class="calibre4">
        While the jump list and change list are like breadcrumb trails that allow us to retrace our steps, the <span class="calibre17">gf</span> and <span class="calibre17">&lt;C-]&gt;</span> commands provide wormholes that transport us from one part of our codebase to another.
      </p>
<script src="scripts/book_local.js" type="text/javascript" class="calibre2"/>
</div>

{% endraw %}

