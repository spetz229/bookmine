---
layout: page
title: "Real World Haskell, 1st Edition"
prev: I_sect15_d1e13471.html
next: I_sect15_d1e13839.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="I_sect15_d1e13471.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="I_sect15_d1e13839.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="I_sect15_d1e13753" class="calibre27" id="I_sect15_d1e13753"></a><h3 id="title-IDATURZC" class="docSection1Title">5.11. Arrays and Objects, and the Module Header</h3><a name="x_un" class="calibre27" id="x_un"></a><p class="docText">Compared<a name="I_indexterm5_d1e13758" class="calibre27" id="I_indexterm5_d1e13758"></a><a name="I_indexterm5_d1e13761" class="calibre27" id="I_indexterm5_d1e13761"></a> to strings,<a name="I_indexterm5_d1e13765" class="calibre27" id="I_indexterm5_d1e13765"></a> pretty printing arrays and objects is a snap. We already
    know that the two are visually similar: each starts with an opening
    character, followed by a series of values separated with commas, followed
    by a closing character. Let's write a function that captures the common
    structure of arrays and objects:</p><pre class="calibre39">-- file: ch05/PrettyJSON.hs
series :: Char -&gt; Char -&gt; (a -&gt; Doc) -&gt; [a] -&gt; Doc
series open close item = enclose open close
                       . fsep . punctuate (char ',') . map item</pre><br class="calibre48"/>
<a name="x_vn" class="calibre27" id="x_vn"></a><p class="docText">We'll start by interpreting this function's type. It takes
    an opening and closing character, then a function that knows how to pretty
    print a value of some unknown type <tt class="calibre34">a</tt>, followed by a
    list of values of type <tt class="calibre34">a</tt>. It then returns a value of
    type Doc.</p><a name="x_sD1" class="calibre27" id="x_sD1"></a><p class="docText">Notice that although our type signature mentions four
    parameters, we listed only three in the definition of the function. We are
    just following the same rule that lets us simplify a definiton such as
    <tt class="calibre34">myLength xs = length xs</tt> to <tt class="calibre34">myLength =
    length</tt>.</p><a name="x_wn" class="calibre27" id="x_wn"></a><p class="docText">We have already written <i class="docEmphasis">enclose</i>, which wraps a Doc value
    in opening and closing characters. The <i class="docEmphasis">fsep</i> function will live in our
    <tt class="calibre34">Prettify</tt> module. It combines a list of Doc
    values into one, possibly wrapping lines if the output will not fit on a
    single line:</p><pre class="calibre39">-- file: ch05/PrettyStub.hs
fsep :: [Doc] -&gt; Doc
fsep xs = undefined</pre><br class="calibre48"/>
<a name="x_tD1" class="calibre27" id="x_tD1"></a><p class="docText">By now, you should be able to define your own stubs in
    <i class="docEmphasis">Prettify.hs</i>, following the examples
    we have supplied. We will not explicitly define any more stubs.</p><a name="x_uD1" class="calibre27" id="x_uD1"></a><p class="docText">The <i class="docEmphasis">punctuate</i>
    function will also live in our <tt class="calibre34">Prettify</tt> module, and we can
    define it in terms of functions for which we've already written
    stubs:</p><pre class="calibre39">-- file: ch05/Prettify.hs
punctuate :: Doc -&gt; [Doc] -&gt; [Doc]
punctuate p []     = []
punctuate p [d]    = [d]
punctuate p (d:ds) = (d &lt;&gt; p) : punctuate p ds</pre><br class="calibre48"/>
<a name="x_xn" class="calibre27" id="x_xn"></a><p class="docText">With this definition of <i class="docEmphasis">series</i>, pretty printing an array is entirely
    straightforward. We add this equation to the end of the block we've
    already written for our <i class="docEmphasis">renderJValue</i>
    function:</p><pre class="calibre39">-- file: ch05/PrettyJSON.hs
renderJValue (JArray ary) = series '[' ']' renderJValue ary</pre><br class="calibre48"/>
<a name="x_yn" class="calibre27" id="x_yn"></a><p class="docText">To pretty print an object, we need to do only a little
    more work. For each element, we have both a name and a value to deal
    with:</p><pre class="calibre39">-- file: ch05/PrettyJSON.hs
renderJValue (JObject obj) = series '{' '}' field obj
    where field (name,val) = string name
                          &lt;&gt; text ": "
                          &lt;&gt; renderJValue val</pre><br class="calibre48"/>
<a href="21061538.html" class="calibre2"><img src="pixel.gif" alt="" border="0" class="calibre31"/></a><ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="I_sect15_d1e13471.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="I_sect15_d1e13839.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

