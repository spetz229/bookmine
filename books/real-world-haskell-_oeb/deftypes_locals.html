---
layout: page
title: "Real World Haskell, 1st Edition"
prev: deftypes_error.html
next: deftypes_offside.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"><a href="21061538.html" class="calibre13"><img src="btn_next_.gif" alt="Next" border="0" class="calibre26"/></a> 
           
          <span class="calibre9"><a target="_self" href="deftypes_error.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="deftypes_offside.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="deftypes_locals" class="calibre27" id="deftypes_locals"></a><h3 id="643999-958" class="docSection1Title">3.9. Introducing Local Variables</h3><a name="x_f4" class="calibre27" id="x_f4"></a><p class="docText">Within the<a name="ch03-variables" class="calibre27" id="ch03-variables"></a><a name="ch03-localvariables" class="calibre27" id="ch03-localvariables"></a> body of a function, we can introduce new local variables
    whenever we need them, using a <tt class="calibre34">let</tt>
    expression.<a name="I_indexterm3_d1e7604" class="calibre27" id="I_indexterm3_d1e7604"></a> Here is a simple function that determines whether we should
    lend some money to a customer. We meet a money reserve of at least 100,
    and we return our new balance after subtracting the amount we have
    loaned:</p><pre class="calibre39">-- file: ch03/Lending.hs
lend amount balance = let reserve    = 100
                          newBalance = balance - amount
                      in if balance &lt; reserve
                         then Nothing
                         else Just newBalance</pre><br class="calibre48"/>
<a name="x_g4" class="calibre27" id="x_g4"></a><p class="docText">The keywords to look out for here are <tt class="calibre34">let</tt>, which starts a block of variable
    declarations, and <tt class="calibre34">in</tt>, which ends it. Each line introduces a
    new variable. The name is on the left of the <tt class="calibre34">=</tt>, and the expression to which it is bound is on
    the right.</p><a name="deftypes_localsd1e7689" class="calibre27" id="deftypes_localsd1e7689"></a><div class="docNote"><p class="docNormalTitle">NOTE</p><p class="calibre37"><a name="x_ng" class="calibre27" id="x_ng"></a></p><p class="docText">Let us reemphasize our wording: a name in a <tt class="calibre34">let</tt> block is bound to<a name="I_indexterm3_d1e7630" class="calibre27" id="I_indexterm3_d1e7630"></a> an <span class="docEmphasis">expression</span>, not to a
      <span class="docEmphasis">value</span>. Because Haskell is a lazy
      language,<a name="I_indexterm3_d1e7642" class="calibre27" id="I_indexterm3_d1e7642"></a> the expression associated with a name won't actually be
      evaluated until it's needed. In the previous example, we could not
      compute the value of <span class="docMonofont">newBalance</span>
      if we did not meet our reserve.</p><a name="x_og" class="calibre27" id="x_og"></a><p class="docText">When we define a variable in a <tt class="calibre34">let</tt> block, we refer to it as a <tt class="calibre34">let</tt><span class="docEmphasis">-bound</span> variable. This
      simply means what it says: we have bound the variable in a <tt class="calibre34">let</tt> block.</p><a name="x_pg" class="calibre27" id="x_pg"></a><p class="docText">Also, our use of whitespace here is important. We'll
      talk in more detail about the layout rules later in this chapter in
      <a class="docLink" href="deftypes_offside.html#deftypes_offside">Section 3.10</a>.</p></div><a name="x_qg" class="calibre27" id="x_qg"></a><p class="docText">We can use the names of a variable in a <tt class="calibre34">let</tt> block both within the block of declarations
    and in the expression that follows<a name="I_indexterm3_d1e7672" class="calibre27" id="I_indexterm3_d1e7672"></a> the <tt class="calibre34">in</tt> keyword.</p><a name="x_rg" class="calibre27" id="x_rg"></a><p class="docText">In general, we'll refer to the places within our code
    where we can use a name as the<a name="I_indexterm3_d1e7681" class="calibre27" id="I_indexterm3_d1e7681"></a><a name="I_indexterm3_d1e7684" class="calibre27" id="I_indexterm3_d1e7684"></a><a name="I_indexterm3_d1e7687" class="calibre27" id="I_indexterm3_d1e7687"></a><a name="I_indexterm3_d1e7690" class="calibre27" id="I_indexterm3_d1e7690"></a> name's <span class="docEmphasis">scope</span>. If we can use a name,
    it's <span class="docEmphasis">in scope</span>; otherwise, it's <span class="docEmphasis">out of
    scope</span>. If a name is visible throughout a source file, we say
    it's at the <span class="docEmphasis">top level</span>.</p><a name="deftypes_localsd1e7774" class="calibre27" id="deftypes_localsd1e7774"></a><h4 id="title-IDA2QSZC" class="docSection1Title">3.9.1. Shadowing</h4><a name="x_i4" class="calibre27" id="x_i4"></a><p class="docText">We can "nest" multiple <tt class="calibre34">let</tt> blocks<a name="I_indexterm3_d1e7718" class="calibre27" id="I_indexterm3_d1e7718"></a><a name="I_indexterm3_d1e7723" class="calibre27" id="I_indexterm3_d1e7723"></a> inside each other in an expression:</p><pre class="calibre39">-- file: ch03/NestedLets.hs
foo = let a = 1
      in let b = 2
         in a + b</pre><br class="calibre48"/>
<a name="x_yg" class="calibre27" id="x_yg"></a><p class="docText">It's perfectly legal, but not exactly wise, to repeat a
      variable name in a nested <tt class="calibre34">let</tt> <span class="docEmphasis">expression</span>:</p><pre class="calibre39">-- file: ch03/NestedLets.hs
bar = let x = 1
      in ((let x = "foo" in x), x)</pre><br class="calibre48"/>
<a name="x_zg" class="calibre27" id="x_zg"></a><p class="docText">Here, the inner <span class="docMonofont">x</span> is hiding, or
      <span class="docEmphasis">shadowing</span>, the outer <span class="docMonofont">x</span>. It has
      the same name, but a different type and value:</p><pre class="calibre39">ghci&gt; <b class="calibre40">bar</b>
("foo",1)
</pre><a name="x_Ah" class="calibre27" id="x_Ah"></a><p class="docText">We can also shadow a function's parameters, leading to
      even stranger results. What is <a name="I_indexterm3_d1e7758" class="calibre27" id="I_indexterm3_d1e7758"></a>the type of this function?</p><pre class="calibre39">-- file: ch03/NestedLets.hs
quux a = let a = "foo"
         in a ++ "eek!"</pre><br class="calibre48"/>
<a name="x_Bh" class="calibre27" id="x_Bh"></a><p class="docText">Because the function's argument <span class="docMonofont">a</span> is
      never used in the body of the function, due to being shadowed by the
      <tt class="calibre34">let</tt>-bound <span class="docMonofont">a</span>, the
      argument can have any type at all:</p><pre class="calibre39">ghci&gt; <b class="calibre40">:type quux</b>
quux :: t -&gt; [Char]
</pre><p class="calibre37"><table border="0" cellspacing="0" cellpadding="1" width="90%" class="calibre41"><tr class="calibre16"><td class="v3"><table width="100%" border="0" cellspacing="0" cellpadding="6" class="calibre42"><tr class="calibre16"><td width="60" valign="top" class="v3"><img src="tip_yellow.gif" alt="" class="calibre43"/></td><td valign="top" class="v3"><p class="docNormalTitle">Compiler warnings are your friends</p><a name="x_Ch" class="calibre27" id="x_Ch"></a><p class="docText">Shadowing can obviously lead to confusion and nasty
        bugs, so <span class="docMonofont">GHC</span> has a helpful
        <i class="docEmphasis">-fwarn-name-shadowing</i> option. <a name="I_indexterm3_d1e7795" class="calibre27" id="I_indexterm3_d1e7795"></a>When enabled, <span class="docMonofont">GHC</span> will print a warning message any
        time we shadow a name.</p></td></tr></table></td></tr></table></p><br class="calibre48"/><a name="deftypes_localsd1e7869" class="calibre27" id="deftypes_localsd1e7869"></a><h4 id="title-IDAOUSZC" class="docSection1Title">3.9.2. The where Clause</h4><a name="x_Dh" class="calibre27" id="x_Dh"></a><p class="docText">We can use<a name="I_indexterm3_d1e7807" class="calibre27" id="I_indexterm3_d1e7807"></a> another mechanism to introduce local variables: the
      <tt class="calibre34">where</tt> clause. The definitions in a
      <tt class="calibre34">where</tt> clause apply to the code that
      <span class="docEmphasis">precedes</span> it. Here's a similar function to <i class="docEmphasis">lend</i>, <a name="I_indexterm3_d1e7824" class="calibre27" id="I_indexterm3_d1e7824"></a>using <tt class="calibre34">where</tt> instead of
      <tt class="calibre34">let</tt>:</p><pre class="calibre39">-- file: ch03/Lending.hs
lend2 amount balance = if amount &lt; reserve * 0.5
                       then Just newBalance
                       else Nothing
    where reserve    = 100
          newBalance = balance - amount</pre><br class="calibre48"/>
<a name="x_Fh" class="calibre27" id="x_Fh"></a><p class="docText">While a <tt class="calibre34">where</tt> clause
      may seem weird initially, it offers a wonderful aid to readability. It
      lets us direct our reader's focus to the important details of an
      expression, with the supporting definitions following afterwards. After
      a while, you may find yourself missing <tt class="calibre34">where</tt> clauses when using languages that lack
      them.</p><a name="x_l4" class="calibre27" id="x_l4"></a><p class="docText">As with <tt class="calibre34">let</tt>
      expressions, whitespace is significant in <tt class="calibre34">where</tt> clauses. We will talk more about the
      layout rules shortly in <a class="docLink" href="deftypes_offside.html#deftypes_offside">Section 3.10</a>.</p><a name="deftypes_locals_functions" class="calibre27" id="deftypes_locals_functions"></a><h4 id="title-IDAVWSZC" class="docSection1Title">3.9.3. Local Functions, Global Variables</h4><a name="x_FL" class="calibre27" id="x_FL"></a><p class="docText">You'll have<a name="I_indexterm3_d1e7859" class="calibre27" id="I_indexterm3_d1e7859"></a><a name="I_indexterm3_d1e7864" class="calibre27" id="I_indexterm3_d1e7864"></a><a name="I_indexterm3_d1e7867" class="calibre27" id="I_indexterm3_d1e7867"></a><a name="I_indexterm3_d1e7872" class="calibre27" id="I_indexterm3_d1e7872"></a> noticed that Haskell's syntax for defining a variable
      looks very similar to its syntax for defining a function. This symmetry
      is <a name="I_indexterm3_d1e7876" class="calibre27" id="I_indexterm3_d1e7876"></a>preserved in <tt class="calibre34">let</tt> and
      <tt class="calibre34">where</tt> blocks; we can define local
      <span class="docEmphasis">functions</span> just as easily as local
      <span class="docEmphasis">variables</span>:</p><pre class="calibre39">-- file: ch03/LocalFunction.hs
pluralise :: String -&gt; [Int] -&gt; [String]
pluralise word counts = map plural counts
    where plural 0 = "no " ++ word ++ "s"
          plural 1 = "one " ++ word
          plural n = show n ++ " " ++ word ++ "s"</pre><br class="calibre48"/>
<a name="x_GL" class="calibre27" id="x_GL"></a><p class="docText">We have defined a local function, <i class="docEmphasis">plural</i>, that consists of several equations.
      Local functions can freely use variables from the scopes that enclose
      them; here, we use <span class="docMonofont">word</span> from the definition of the
      outer function <i class="docEmphasis">pluralise</i>. In the
      definition of <i class="docEmphasis">pluralise</i>, the
      <i class="docEmphasis">map</i> function (which we'll be
      revisiting in the next chapter) applies the local function <i class="docEmphasis">plural</i> to every element of the
      <span class="docMonofont">counts</span> list.</p><a name="x_Gh" class="calibre27" id="x_Gh"></a><p class="docText">We can also define variables, as well as functions, at
      the top level of a source file:</p><pre class="calibre39">-- file: ch03/GlobalVariable.hs
itemName = "Weighted Companion Cube"</pre><br class="calibre48"/>
<ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"><a href="21061538.html" class="calibre2"><img src="btn_next_.gif" alt="Next" border="0" class="calibre31"/></a> 
           
          <span class="calibre33"><a target="_self" href="deftypes_error.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="deftypes_offside.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

