---
layout: page
title: "Real World Haskell, 1st Edition"
prev: I_sect19_d1e23147.html
next: I_sect19_d1e23452.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="I_sect19_d1e23147.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="I_sect19_d1e23452.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="find_simpleFind" class="calibre27" id="find_simpleFind"></a><h3 id="title-IDAKATNE" class="docSection1Title">9.3. A Naive Finding Function</h3><a name="x_HO" class="calibre27" id="x_HO"></a><p class="docText">We can use our <i class="docEmphasis">getRecursiveContents</i> function as the basis for
    a simple-minded file finder:</p><pre class="calibre39">-- file: ch09/SimpleFinder.hs
import RecursiveContents (getRecursiveContents)

simpleFind :: (FilePath -&gt; Bool) -&gt; FilePath -&gt; IO [FilePath]

simpleFind p path = do
  names &lt;- getRecursiveContents path
  return (filter p names)</pre><br class="calibre48"/>
<a name="x_IO" class="calibre27" id="x_IO"></a><p class="docText">This function takes a predicate that we use to filter the
    names returned by <i class="docEmphasis">getRecursiveContents</i>. Each name passed to the
    predicate is a complete path, so how can we perform a common operation
    such as "find all files ending in the extension
    <i class="docEmphasis">.c</i>"?</p><a name="x_JO" class="calibre27" id="x_JO"></a><p class="docText">The <tt class="calibre34">System.FilePath</tt> module<a name="I_indexterm9_d1e23372" class="calibre27" id="I_indexterm9_d1e23372"></a> contains numerous invaluable functions that help us to
    manipulate filenames. In this case, we want <i class="docEmphasis">takeExtension</i>:</p><pre class="calibre39">ghci&gt; <b class="calibre40">:m +System.FilePath</b>ghci&gt; <b class="calibre40">:type takeExtension</b>
takeExtension :: FilePath -&gt; String
ghci&gt; <b class="calibre40">takeExtension "foo/bar.c"</b>
Loading package filepath-1.1.0.0 ... linking ... done.
".c"
ghci&gt; <b class="calibre40">takeExtension "quux"</b>
""</pre><a name="x_KO" class="calibre27" id="x_KO"></a><p class="docText">This gives us a simple matter of writing a function that
    takes a path, extracts its extension, and compares it with
    <i class="docEmphasis">.c</i>:</p><pre class="calibre39">ghci&gt; <b class="calibre40">:load SimpleFinder</b>
[1 of 2] Compiling RecursiveContents ( RecursiveContents.hs, interpreted )
[2 of 2] Compiling Main             ( SimpleFinder.hs, interpreted )
Ok, modules loaded: RecursiveContents, Main.
ghci&gt; <b class="calibre40">:type simpleFind (\p -&gt; takeExtension p == ".c")</b>
simpleFind (\p -&gt; takeExtension p == ".c") :: FilePath -&gt; IO [FilePath]</pre><a name="x_LO" class="calibre27" id="x_LO"></a><p class="docText">While <i class="docEmphasis">simpleFind</i>
    works, it has a few glaring problems. The first is that the predicate is
    not very expressive. It can only look at the name of a directory entry; it
    cannot, for example, find out whether it's a file or a directory. This
    means that our attempt to use <i class="docEmphasis">simpleFind</i> will list directories ending in
    <i class="docEmphasis">.c</i> as well as files with the same extension.</p><a name="x_MO" class="calibre27" id="x_MO"></a><p class="docText">The second problem is that <i class="docEmphasis">simpleFind</i> gives us no control over how it
    traverses the filesystem. To see why this is significant, consider the
    problem of searching for a source file in a tree managed by the Subversion
    revision control system. Subversion maintains a private <i class="docEmphasis">.svn</i> directory in every directory that it
    manages; each one contains many subdirectories and files that are of no
    interest to us. While we can easily filter out any path containing
    <i class="docEmphasis">.svn</i>, it's more efficient to simply
    avoid traversing these directories in the first place. For example, one of
    us has a Subversion source tree containing 45,000 files, 30,000 of which
    are stored in 1,200 different <i class="docEmphasis">.svn</i>
    directories. It's cheaper to avoid traversing those 1,200 directories than
    to filter out the 30,000 files they contain.</p><a name="x_NO" class="calibre27" id="x_NO"></a><p class="docText">Finally, <i class="docEmphasis">simpleFind</i>
    is strict, because it consists of a series of actions executed in the
    IO monad. If we have a million files to traverse, we
    encounter a long delay, and then receive one huge result containing a
    million names. This is bad for both resource usage and responsiveness. We
    might prefer a lazy stream of results delivered as they arrive.</p><a name="x_OO" class="calibre27" id="x_OO"></a><p class="docText">In the sections that follow, we'll overcome each one of
    these problems.</p>
<a href="21061538.html" class="calibre2"><img src="pixel.gif" alt="" border="0" class="calibre31"/></a><ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="I_sect19_d1e23147.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="I_sect19_d1e23452.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

