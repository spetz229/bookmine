---
layout: page
title: "Real World Haskell, 1st Edition"
prev: bloomfilter_split_001.html
next: I_sect126_d1e49566.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="bloomfilter_split_000.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="I_sect126_d1e49566.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="I_sect126_d1e49402" class="calibre27" id="I_sect126_d1e49402"></a><h3 id="title-IDA33MEK" class="docSection1Title">26.1. Introducing the Bloom Filter</h3><a name="x_L71" class="calibre27" id="x_L71"></a><p class="docText">A Bloom filter is a<a name="ch26-bloomfilters" class="calibre27" id="ch26-bloomfilters"></a> set-like data structure that is highly efficient in its use
    of space. It supports two operations only: insertion and membership
    querying. Unlike a normal set data structure, a Bloom filter can give
    incorrect answers. If we query it to see whether an element that we have
    inserted is present, it will answer affirmatively. If we query for an
    element that we have <span class="docEmphasis">not</span> inserted, it
    <span class="docEmphasis">might</span> incorrectly claim that the element is
    present.</p><a name="x_M71" class="calibre27" id="x_M71"></a><p class="docText">For many applications, a low rate of false positives is
    tolerable. For instance, the job of a network traffic shaper is to
    throttle bulk transfers (e.g., BitTorrent) so that interactive sessions
    (such as <i class="docEmphasis">ssh</i> sessions or games) see
    good response times. A traffic shaper might use a Bloom filter to
    determine whether a packet belonging to a particular session is bulk or
    interactive. If it misidentifies 1 in 10,000 bulk packets as interactive
    and fails to throttle it, nobody will notice.</p><a name="x_N71" class="calibre27" id="x_N71"></a><p class="docText">The attraction of a Bloom filter is its space efficiency.
    If we want to build a spell checker and have a dictionary of 500,000
    words, a set data structure might consume 20 <span class="docEmphasis">megabytes</span> of space. A Bloom filter, in
    contrast, would consume about half a megabyte, at the cost of missing
    perhaps 1% of misspelled words.</p><a name="x_O71" class="calibre27" id="x_O71"></a><p class="docText">Behind the scenes, a Bloom filter is remarkably simple.
    It consists of a bit array<a name="I_indexterm26_d1e49429" class="calibre27" id="I_indexterm26_d1e49429"></a> and a handful of hash functions. We'll use
    <span class="docEmphasis">k</span> for the number of hash functions. If we want to
    insert a value into the Bloom filter, we compute <span class="docEmphasis">k</span>
    hashes of the value and turn on those bits in the bit array. If we want to
    see whether a value is present, we compute <span class="docEmphasis">k</span> hashes
    and check all of those bits in the array to see if they are turned
    on.</p><a name="x_P71" class="calibre27" id="x_P71"></a><p class="docText">To see how this works, let's say we want to insert the
    strings <tt class="calibre34">"foo"</tt> and <tt class="calibre34">"bar"</tt> into a Bloom filter that
    is 8 bits wide, and we have two hash functions:</p><div class="calibre15"><ol class="docList2" type="1"><li class="calibre19"><div class="calibre15"><p class="docText">Compute the two hashes of <tt class="calibre34">"foo"</tt>, and get
        the values <tt class="calibre34">1</tt> and <tt class="calibre34">6</tt>.</p></div></li><li class="calibre19"><div class="calibre15"><p class="docText">Set bits <tt class="calibre34">1</tt> and <tt class="calibre34">6</tt> in the bit
        array.</p></div></li><li class="calibre19"><div class="calibre15"><p class="docText">Compute the two hashes of <tt class="calibre34">"bar"</tt>, and get
        the values <tt class="calibre34">6</tt> and <tt class="calibre34">3</tt>.</p></div></li><li class="calibre19"><div class="calibre15"><p class="docText">Set bits <tt class="calibre34">6</tt> and <tt class="calibre34">3</tt> in the bit
        array.</p></div></li></ol></div><a name="x_U71" class="calibre27" id="x_U71"></a><p class="docText">This example should make it clear why we cannot remove an
    element from a Bloom filter: both <tt class="calibre34">"foo"</tt> and
    <tt class="calibre34">"bar"</tt> resulted in bit 6 being set.</p><a name="x_V71" class="calibre27" id="x_V71"></a><p class="docText">Suppose we now want to query the Bloom filter to see
    whether the values <tt class="calibre34">"quux"</tt> and <tt class="calibre34">"baz"</tt> are
    present:</p><div class="calibre15"><ol class="docList2" type="1"><li class="calibre19"><div class="calibre15"><p class="docText">Compute the two hashes of <tt class="calibre34">"quux"</tt>, and
        get the values <tt class="calibre34">4</tt> and <tt class="calibre34">0</tt>.</p></div></li><li class="calibre19"><div class="calibre15"><p class="docText">Check bit <tt class="calibre34">4</tt> in the bit array. It is not
        set, so <tt class="calibre34">"quux"</tt> cannot be present. We do not need to check
        bit <tt class="calibre34">0</tt>.</p></div></li><li class="calibre19"><div class="calibre15"><p class="docText">Compute the two hashes of <tt class="calibre34">"baz"</tt> and get
        the values <tt class="calibre34">1</tt> and <tt class="calibre34">3</tt>.</p></div></li><li class="calibre19"><div class="calibre15"><p class="docText">Check bit <tt class="calibre34">1</tt> in the bit array. It is set,
        as is bit <tt class="calibre34">3</tt>, so we say that <tt class="calibre34">"baz"</tt> is present
        even though it is not. We have reported a false positive.</p></div></li></ol></div><a name="x_a71" class="calibre27" id="x_a71"></a><p class="docText">For a survey of some of the uses of Bloom filters in
    networking, see "Network Applications of Bloom Filters: A Survey" by
    Andrei Broder and Michael Mitzenmacher (see ).</p>
<ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="bloomfilter_split_000.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="I_sect126_d1e49566.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

