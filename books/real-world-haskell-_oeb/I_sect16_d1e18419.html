---
layout: page
title: "Real World Haskell, 1st Edition"
prev: jsonclass_instances_split_002.html
next: typeclasses_conclusion.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="jsonclass_instances_split_000.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="typeclasses_conclusion.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="I_sect16_d1e18419" class="calibre27" id="I_sect16_d1e18419"></a><h3 id="title-IDA3QZXD" class="docSection1Title">6.10. The Dreaded Monomorphism Restriction</h3><a name="x_H11" class="calibre27" id="x_H11"></a><p class="docText">The<a name="I_indexterm6_d1e18424" class="calibre27" id="I_indexterm6_d1e18424"></a><a name="I_indexterm6_d1e18425" class="calibre27" id="I_indexterm6_d1e18425"></a><a name="ch06-monomorphism" class="calibre27" id="ch06-monomorphism"></a><a name="ch06-typemono" class="calibre27" id="ch06-typemono"></a> Haskell 98 standard has a subtle feature that can sometimes
    bite us in unexpected circumstances. Here's a simple function definition
    that illustrates the issue:</p><pre class="calibre39">-- file: ch06/Monomorphism.hs
myShow = show</pre><br class="calibre48"/>
<a name="x_I11" class="calibre27" id="x_I11"></a><p class="docText">If we try to load this definition into <i class="docEmphasis">ghci</i>, it issues a peculiar complaint:</p><pre class="calibre39">ghci&gt; <b class="calibre40">:load Monomorphism</b>
[1 of 1] Compiling Main             ( Monomorphism.hs, interpreted )

Monomorphism.hs:2:9:
    Ambiguous type variable `a' in the constraint:
      `Show a' arising from a use of `show' at Monomorphism.hs:2:9-12
    Possible cause: the monomorphism restriction applied to the following:
      myShow :: a -&gt; String (bound at Monomorphism.hs:2:0)
    Probable fix: give these definition(s) an explicit type signature
                  or use -fno-monomorphism-restriction
Failed, modules loaded: none.
</pre><a name="x_J11" class="calibre27" id="x_J11"></a><p class="docText">The <span class="docEmphasis">monomorphism restriction</span> to
    which the error message refers is a part of the <a name="I_indexterm6_d1e18453" class="calibre27" id="I_indexterm6_d1e18453"></a>Haskell 98 standard. <span class="docEmphasis">Monomorphism</span> is
    simply the opposite of polymorphism: it indicates that an expression has
    exactly one type. The <span class="docEmphasis">restriction</span> lies in the fact
    that Haskell sometimes forces a declaration to be less polymorphic than we
    would expect.</p><a name="x_K11" class="calibre27" id="x_K11"></a><p class="docText">We mention the monomorphism restriction here because
    although it isn't specifically related to typeclasses, they usually
    provide the circumstances in which it crops up.</p><p class="calibre37"><table border="0" cellspacing="0" cellpadding="1" width="90%" class="calibre41"><tr class="calibre16"><td class="v3"><table width="100%" border="0" cellspacing="0" cellpadding="6" class="calibre42"><tr class="calibre16"><td width="60" valign="top" class="v3"><img src="tip_yellow.gif" alt="" class="calibre43"/></td><td valign="top" class="v3"><a name="x_L11" class="calibre27" id="x_L11"></a><p class="docText">It's possible that you will not run into the
      monomorphism restriction in real code for a long time. We don't think
      you need to try to remember the details of this section. It should
      suffice to make a mental note of its existence, until eventually
      <span class="docMonofont">GHC</span> complains with something
      such as the just shown error message. If that occurs, simply remember
      that you read about the error in this chapter, and come back for
      guidance.</p></td></tr></table></td></tr></table></p><br class="calibre48"/><a name="x_M11" class="calibre27" id="x_M11"></a><p class="docText">We won't attempt to explain the monomorphism <span class="docEmphasis">restriction</span>.<sup class="docFootnote"><a class="docLink1" href="#x_M11d1e18833">[15]</a></sup> The consensus within the Haskell community is that it
    doesn't arise often, it is tricky to explain, and it provides almost no
    practical benefit. So, it mostly serves to trip people up. For an example
    of its trickiness, while the definition provided previously falls afoul of
    it, the following two compile without problems:</p><blockquote class="calibre30"><p class="docFootnote1"><sup class="calibre50"><a name="x_M11d1e18833" class="calibre5" id="x_M11d1e18833">[15]</a></sup> If you simply <span class="docEmphasis">must</span> read the gory
        details, see <a class="docLink" target="_blank" href="">section
        4.5.5</a> of the Haskell 98 Report.</p></blockquote><pre class="calibre39">-- file: ch06/Monomorphism.hs
myShow2 value = show value

myShow3 :: (Show a) =&gt; a -&gt; String
myShow3 = show</pre><br class="calibre48"/>
<a name="x_O11" class="calibre27" id="x_O11"></a><p class="docText">As these alternative definitions suggest, if <span class="docMonofont">GHC</span> complains about the monomorphism
    restriction, we have three easy ways to address the error:</p><ul class="calibre18"><li class="calibre19"><p class="docText">Make the function's arguments explicit, instead of
        leaving them implicit.</p></li><li class="calibre19"><p class="docText">Give the definition an explicit type signature,
        instead of making the compiler infer its type.</p></li><li class="calibre19"><p class="docText">Leave the code untouched and compile the module with
        <a name="I_indexterm6_d1e18506" class="calibre27" id="I_indexterm6_d1e18506"></a><a name="I_indexterm6_d1e18511" class="calibre27" id="I_indexterm6_d1e18511"></a><a name="I_indexterm6_d1e18516" class="calibre27" id="I_indexterm6_d1e18516"></a>the language extension
        <tt class="calibre34">NoMonomorphismRestriction</tt> enabled. This disables the
        monomorphism <span class="docEmphasis">restriction</span>.</p></li></ul><a name="x_S11" class="calibre27" id="x_S11"></a><p class="docText">Because the monomorphism restriction is unwanted and
    unloved, it will almost certainly be dropped from the next revision of the
    Haskell standard. This does not quite mean that compiling with
    <tt class="calibre34">NoMonomorphismRestriction</tt> is always the right thing to
    do—some Haskell compilers (including older versions of <span class="docMonofont">GHC</span>) do not understand this extension, but
    they'll accept either of the other approaches to making the error
    disappear. If this degree of portability isn't a concern to you, then by
    all means enable the language extension.</p>
<a href="21061538.html" class="calibre2"><img src="pixel.gif" alt="" border="0" class="calibre31"/></a><ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="jsonclass_instances_split_000.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="typeclasses_conclusion.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

