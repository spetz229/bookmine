---
layout: page
title: "Real World Haskell, 1st Edition"
prev: databases_connect.html
next: databases_simplequeries.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="databases_connect.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="databases_simplequeries.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="databases_transactions" class="calibre27" id="databases_transactions"></a><h3 id="title-IDAR5I1D" class="docSection1Title">21.4. Transactions</h3><a name="x_Rc" class="calibre27" id="x_Rc"></a><p class="docText">Most modern SQL databases<a name="I_indexterm21_d1e44464" class="calibre27" id="I_indexterm21_d1e44464"></a> have a notion of transactions. A transaction is designed to
    ensure that all components of a modification get applied, or that none of
    them do. Furthermore, transactions help prevent other processes accessing
    the same database from seeing partial data from modifications that are in
    progress.</p><a name="x_Sc" class="calibre27" id="x_Sc"></a><p class="docText">Many databases require you to either explicitly commit all
    your changes before they appear on disk, or to run in an
    <span class="docEmphasis">autocommit</span> mode.<a name="I_indexterm21_d1e44473" class="calibre27" id="I_indexterm21_d1e44473"></a> Autocommit mode runs an implicit commit after every
    statement. This may make the adjustment to transactional databases easier
    for programmers not accustomed to them, but it is just a hindrance to
    people who actually want to use multistatement transactions.</p><a name="x_Tc" class="calibre27" id="x_Tc"></a><p class="docText">HDBC intentionally does not support autocommit mode. When
    you modify data in your databases, you must explicitly cause it to be
    committed to disk. There are two ways to do that in HDBC: you can call
    <tt class="calibre34">commit</tt> when you're ready to write the
    data to disk, or you can use the <tt class="calibre34">withTransaction</tt> function<a name="I_indexterm21_d1e44485" class="calibre27" id="I_indexterm21_d1e44485"></a> to wrap around your modification code. <tt class="calibre34">withTransaction</tt> will cause data to be committed
    upon successful completion of your function.</p><a name="x_Uc" class="calibre27" id="x_Uc"></a><p class="docText">Sometimes a problem will occur while you are working on
    writing data to the database. Perhaps you get an error from the database
    or discover a problem with the data. In these instances, you can "roll
    back" your changes. This will cause all changes you made since your last
    <tt class="calibre34">commit</tt> or rollback to be forgotten. In
    HDBC, you can call the <tt class="calibre34">rollback</tt> function to do this. If you are
    using <tt class="calibre34">withTransaction</tt>, any uncaught
    exception will cause a rollback to be issued.</p><a name="x_Vc" class="calibre27" id="x_Vc"></a><p class="docText">Note that a roll back operation rolls back only the
    changes since the last <tt class="calibre34">commit</tt>, <tt class="calibre34">rollback</tt>, or <tt class="calibre34">withTransaction</tt>. A database does not maintain an
    extensive history like a version-control system. You will see examples of
    <tt class="calibre34">commit</tt> later in this chapter.</p><p class="calibre37"><table border="0" cellspacing="0" cellpadding="1" width="90%" class="calibre41"><tr class="calibre16"><td class="v3"><table width="100%" border="0" cellspacing="0" cellpadding="6" class="calibre42"><tr class="calibre16"><td width="60" valign="top" class="v3"><img src="warning_yellow.gif" alt="" class="calibre44"/></td><td valign="top" class="v3"><a name="x_Wc" class="calibre27" id="x_Wc"></a><p class="docText">One popular database, MySQL, does not support
      transactions with its default table type. In its default configuration,
      MySQL will silently ignore calls to <tt class="calibre34">commit</tt> or <tt class="calibre34">rollback</tt> and will commit all changes to disk
      immediately. The HDBC ODBC driver<a name="I_indexterm21_d1e44526" class="calibre27" id="I_indexterm21_d1e44526"></a> has instructions for configuring MySQL to indicate to
      HDBC that it does not support transactions, which will cause <tt class="calibre34">commit</tt> and <tt class="calibre34">rollback</tt> to generate errors. Alternatively,
      you can use InnoDB tables with MySQL, which do support transactions.
      InnoDB tables are recommended for use with HDBC.</p></td></tr></table></td></tr></table></p><br class="calibre48"/>
<ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="databases_connect.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="databases_simplequeries.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

