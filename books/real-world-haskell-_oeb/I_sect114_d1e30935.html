---
layout: page
title: "Real World Haskell, 1st Edition"
prev: I_sect114_d1e30852.html
next: monads_class.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="I_sect114_d1e30852.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="monads_class.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="I_sect114_d1e30935" class="calibre27" id="I_sect114_d1e30935"></a><h3 id="title-IDAU3BZG" class="docSection1Title">14.3. Looking for Shared Patterns</h3><a name="x_iW" class="calibre27" id="x_iW"></a><p class="docText">When<a name="I_indexterm14_d1e30940" class="calibre27" id="I_indexterm14_d1e30940"></a> we look at the preceding examples in detail, they don't
    seem to have much in common. Obviously, they're both concerned with
    chaining functions together and hiding details to let us write tidier
    code. However, let's take a step back and consider them in
    <span class="docEmphasis">less</span> detail.</p><a name="x_jW" class="calibre27" id="x_jW"></a><p class="docText">First, let's look at the type definitions:</p><pre class="calibre39">-- file: ch14/Maybe.hs
data Maybe a = Nothing
             | Just a</pre><br class="calibre48"/>
<pre class="calibre39">-- file: ch10/Parse.hs
newtype Parse a = Parse {
      runParse :: ParseState -&gt; Either String (a, ParseState)
    }</pre><br class="calibre48"/>
<a name="x_kW" class="calibre27" id="x_kW"></a><p class="docText">The common feature of these two types is that each has a
    single type parameter on the left of the definition, which appears
    somewhere on the right. These are thus generic types, which know nothing
    about their payloads.</p><a name="x_lW" class="calibre27" id="x_lW"></a><p class="docText">Next, we'll examine the chaining functions that we wrote
    for the two types:</p><pre class="calibre39">ghci&gt; <b class="calibre40">:type (&gt;&gt;?)</b>
(&gt;&gt;?) :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
</pre><pre class="calibre39">ghci&gt; <b class="calibre40">:type (==&gt;)</b>
(==&gt;) :: Parse a -&gt; (a -&gt; Parse b) -&gt; Parse b
</pre><a name="x_mW" class="calibre27" id="x_mW"></a><p class="docText">These functions have strikingly similar types. If we were
    to turn those type constructors into a type variable, we'd end up with a
    single more abstract type:</p><pre class="calibre39">-- file: ch14/Maybe.hs
chain :: m a -&gt; (a -&gt; m b) -&gt; m b</pre><br class="calibre48"/>
<a name="x_nW" class="calibre27" id="x_nW"></a><p class="docText">Finally, in each case, we have a function that takes a
    "plain" value and "injects" it into the target
    type. For Maybe, this function is simply the value
    constructor <tt class="calibre34">Just</tt>, but the injector for Parse is
    more complicated:</p><pre class="calibre39">-- file: ch10/Parse.hs
identity :: a -&gt; Parse a
identity a = Parse (\s -&gt; Right (a, s))</pre><br class="calibre48"/>
<a name="x_oW" class="calibre27" id="x_oW"></a><p class="docText">Again, it's not the details or complexity that we're
    interested in, it's the fact that each of these types has<a name="I_indexterm14_d1e30996" class="calibre27" id="I_indexterm14_d1e30996"></a> an "injector" function, which looks like
    this:</p><pre class="calibre39">-- file: ch14/Maybe.hs
inject :: a -&gt; m a</pre><br class="calibre48"/>
<a name="x_pW" class="calibre27" id="x_pW"></a><p class="docText">It is <span class="docEmphasis">exactly</span> these three properties,
    and a few rules about how we can use them together, that define a monad in
    Haskell. Let's revisit the preceding list in condensed <a name="I_indexterm14_d1e31010" class="calibre27" id="I_indexterm14_d1e31010"></a>form:</p><ul class="calibre18"><li class="calibre19"><p class="docText">A type constructor <span class="docMonofont">m</span>.</p></li><li class="calibre19"><p class="docText">A function of type m a -&gt; (a -&gt; m b) -&gt;
        m b for chaining the output of one function into the input of
        another.</p></li><li class="calibre19"><p class="docText">A function of type a -&gt; m a for
        injecting a normal value into the chain, that is, it wraps a type
        a with the type constructor m.</p></li></ul><a name="x_tW" class="calibre27" id="x_tW"></a><p class="docText">The properties that make the Maybe type a
    monad are its type constructor Maybe a, our chaining function
    <i class="docEmphasis">(&gt;&gt;?)</i>, and the injector
    function <i class="docEmphasis">Just</i>.</p><a name="x_uW" class="calibre27" id="x_uW"></a><p class="docText">For Parse, the corresponding properties are
    the type constructor Parse a, the chaining function <i class="docEmphasis">(==&gt;)</i>, and the injector function <i class="docEmphasis">identity</i>.</p><a name="x_vW" class="calibre27" id="x_vW"></a><p class="docText">We intentionally have said nothing about how the chaining
    and injection functions of a monad should behave, because this almost
    doesn't matter. In fact, monads are <span class="docEmphasis">ubiquitous</span> in Haskell code precisely because
    they are so simple. Many common programming patterns have a monadic
    structure: passing around implicit data or short-<span class="docEmphasis">circuiting</span> a chain of evaluations if one
    fails, to choose but two.</p>
<a href="21061538.html" class="calibre2"><img src="pixel.gif" alt="" border="0" class="calibre31"/></a><ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="I_sect114_d1e30852.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="monads_class.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

