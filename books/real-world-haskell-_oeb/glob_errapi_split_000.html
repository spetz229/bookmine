---
layout: page
title: "Real World Haskell, 1st Edition"
prev: glob_use_split_001.html
next: glob_errapi_split_001.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="glob_use_split_000.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="glob_work_split_000.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="glob_errapi" class="calibre27" id="glob_errapi"></a><h3 id="title-IDAN124G" class="docSection1Title">8.8. Handling Errors Through API Design</h3><a name="x_DH" class="calibre27" id="x_DH"></a><p class="docText">It's not necessarily <a name="I_indexterm8_d1e22939" class="calibre27" id="I_indexterm8_d1e22939"></a><a name="I_indexterm8_d1e22944" class="calibre27" id="I_indexterm8_d1e22944"></a>a disaster if our <i class="docEmphasis">globToRegex</i> is passed a malformed pattern.
    Perhaps a user mistyped a pattern, in which case, we'd like to be able to
    report a meaningful error message.</p><a name="x_EH" class="calibre27" id="x_EH"></a><p class="docText">Calling the <i class="docEmphasis">error</i>
    function<a name="I_indexterm8_d1e22956" class="calibre27" id="I_indexterm8_d1e22956"></a> when this kind of problem occurs can be a drastic response
    (exploring its consequences was the focus of <a class="docLink" href="glob_use_split_000.html#ch07_q_error">Exercises</a>). The <i class="docEmphasis">error</i>
    throws an exception. Pure Haskell code cannot deal with exceptions, so
    control is going to rocket out of our pure code into the nearest caller
    that lives in <i class="docEmphasis">IO</i> and has an appropriate exception
    handler installed. If no such handler is installed, the Haskell runtime
    will default to terminating our program (or print a nasty error message,
    in <i class="docEmphasis">ghci</i>).</p><a name="x_FH" class="calibre27" id="x_FH"></a><p class="docText">So calling <i class="docEmphasis">error</i> is a
    little like pulling the handle of a fighter plane's ejection seat. We're
    bailing out of a catastrophic situation that we can't deal with
    gracefully, and there's likely to be a lot of flaming wreckage strewn
    about by the time we hit the ground.</p><a name="x_GH" class="calibre27" id="x_GH"></a><p class="docText">We've established that <i class="docEmphasis">error</i> is for disasters, but we're still using
    it in <i class="docEmphasis">globToRegex</i>. In that case,
    malformed input should be rejected, but not turned into a big deal. What
    would be a better way to handle this?</p><a name="x_HH" class="calibre27" id="x_HH"></a><p class="docText">Haskell's type system and libraries to the rescue! We can
    encode the possibility of failure in the type signature of <i class="docEmphasis">globToRegex</i> using the predefined
    Either type:</p><pre class="calibre39">-- file: ch08/GlobRegexEither.hs
type GlobError = String

globToRegex :: String -&gt; Either GlobError String</pre><br class="calibre48"/>
<a name="x_IH" class="calibre27" id="x_IH"></a><p class="docText">A value returned by <i class="docEmphasis">globToRegex</i> will now be either <tt class="calibre34">Left "an error message"</tt> or <tt class="calibre34">Right "a valid regexp"</tt>. This return type forces
    our callers to deal with the possibility of error. (You'll find that this
    use of the Either type occurs frequently in Haskell
    code.)</p><a name="I_sidebar8_d1e23009" class="calibre27" id="I_sidebar8_d1e23009"></a></td>
                    </tr>
                  </table>
                </div>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

