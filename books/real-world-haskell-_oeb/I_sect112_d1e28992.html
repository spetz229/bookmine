---
layout: page
title: "Real World Haskell, 1st Edition"
prev: I_sect112_d1e28808.html
next: I_sect112_d1e29065.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="I_sect112_d1e28808.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="I_sect112_d1e29065.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="I_sect112_d1e28992" class="calibre27" id="I_sect112_d1e28992"></a><h3 id="title-IDAWRD4H" class="docSection1Title">12.11. Working with Row Data</h3><a name="x_IW" class="calibre27" id="x_IW"></a><p class="docText">We've mentioned<a name="I_indexterm12_d1e28997" class="calibre27" id="I_indexterm12_d1e28997"></a> repeatedly that we are taking a single row from our image.
    Here's how:</p><pre class="calibre39">-- file: ch12/Barcode.hs
withRow :: Int -&gt; Pixmap -&gt; (RunLength Bit -&gt; a) -&gt; a
withRow n greymap f = f . runLength . elems $ posterized
    where posterized = threshold 0.4 . fmap luminance . row n $ greymap</pre><br class="calibre48"/>
<a name="x_JW" class="calibre27" id="x_JW"></a><p class="docText">The <i class="docEmphasis">withRow</i> function
    takes a row, converts it to monochrome, and then calls another function on
    the run length encoded row data. To get the row data, it calls <i class="docEmphasis">row</i>:</p><pre class="calibre39">-- file: ch12/Barcode.hs
row :: (Ix a, Ix b) =&gt; b -&gt; Array (a,b) c -&gt; Array a c
row j a = ixmap (l,u) project a
    where project i = (i,j)
          ((l,_), (u,_)) = bounds a</pre><br class="calibre48"/>
<a name="x_KW" class="calibre27" id="x_KW"></a><p class="docText">This function takes a bit of explaining. Whereas <i class="docEmphasis">fmap</i> transforms the <span class="docEmphasis">values</span>
    in an array, <i class="docEmphasis">ixmap</i> transforms the
    <span class="docEmphasis">indices</span> of an array.<a name="I_indexterm12_d1e29027" class="calibre27" id="I_indexterm12_d1e29027"></a> It's a very powerful function that lets us
    "slice" an array however we please.</p><a name="x_LW" class="calibre27" id="x_LW"></a><p class="docText">The first argument to <i class="docEmphasis">ixmap</i> is the bounds of the new array. These
    bounds can be of a different dimension than the source array. In
    <tt class="calibre34">row</tt>, for example, we're extracting a one-dimensional array
    from a two-dimensional array.</p><a name="x_MW" class="calibre27" id="x_MW"></a><p class="docText">The second argument is a <span class="docEmphasis">projection</span>
    function.<a name="I_indexterm12_d1e29048" class="calibre27" id="I_indexterm12_d1e29048"></a> This takes an index from the new array and returns an index
    into the source array. The value at that projected index then becomes the
    value in the new array at the original index. For example, if we pass
    <tt class="calibre34">2</tt> into the projection function and it returns
    <tt class="calibre34">(2,2)</tt>, the element at index <tt class="calibre34">2</tt> of the new array
    will be taken from element <tt class="calibre34">(2,2)</tt> of the source array.</p>
<a href="21061538.html" class="calibre2"><img src="pixel.gif" alt="" border="0" class="calibre31"/></a><ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="I_sect112_d1e28808.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="I_sect112_d1e29065.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

