---
layout: page
title: "Real World Haskell, 1st Edition"
prev: I_sect15_d1e13065.html
next: I_sect15_d1e13228.html
book_path: books/real-world-haskell-_oeb/
---
{% include JB/setup %}
{% raw %}
<div>

    <a name="toppage" class="calibre5" id="toppage"></a>
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody">
      <tr valign="top" class="calibre6">
        <td class="calibre7">
          <a name="MainContent" class="calibre5" id="MainContent"></a>
          <table width="95%" class="sfbody">
            <tr class="calibre6">
              <td class="v">
                <!--Copyright (c) 2002 Safari Tech Books Online-->
                <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody">
                  <tr class="calibre6">
                    <td valign="middle" class="v1" height="5">
                      <img src="pixel.gif" alt="" border="0" class="calibre8"/>
                    </td>
                  </tr>
                  <tr class="calibre6">
                    <td valign="middle" class="v1">
                      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody">
                        <tr class="calibre6">
                          <td class="v"><span class="calibre9"> </span>
                   
                  <span class="calibre9">   </span>
             <span class="calibre9"> </span></td>
                        </tr>
                      </table>
                    </td>
                    <td class="v1"/>
                    <td valign="middle" class="v2"> 
           
          <span class="calibre9"><a target="_self" href="I_sect15_d1e13065.html" title="Previous section" class="calibre13"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre14"/></a></span>
				
				 
				
				<span class="calibre9"><a target="_self" href="I_sect15_d1e13228.html" title="Next section" class="calibre13"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre14"/></a></span></td>
                  </tr>
                </table>
                <div id="section" class="calibre15">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v3">Safari IT Books Language Constructs Functional Programming Haskell Safari IT Books Programming Programming Programming Bryan O'Sullivan  Donald Bruce Stewart  John Goerzen  O'Reilly Media, Inc. Real World Haskell, 1st Edition<a name="I_sect15_d1e13203" class="calibre27" id="I_sect15_d1e13203"></a><h3 id="title-IDAGTRZD" class="docSection1Title">5.6. Printing JSON Data</h3><a name="x_ii" class="calibre27" id="x_ii"></a><p class="docText">Now that we have a Haskell representation for JSON's
    types, we'd like to be able to take Haskell values and render them as JSON
    data.</p><a name="x_ji" class="calibre27" id="x_ji"></a><p class="docText">There are a few ways we could go about this. Perhaps the
    most direct would be to write a rendering function that prints a value in
    JSON form. Once we're done, we'll explore some more interesting
    approaches.</p><pre class="calibre39">-- file: ch05/PutJSON.hs
module PutJSON where

import Data.List (intercalate)
import SimpleJSON

renderJValue :: JValue -&gt; String

renderJValue (JString s)   = show s
renderJValue (JNumber n)   = show n
renderJValue (JBool True)  = "true"
renderJValue (JBool False) = "false"
renderJValue JNull         = "null"

renderJValue (JObject o) = "{" ++ pairs o ++ "}"
  where pairs [] = ""
        pairs ps = intercalate ", " (map renderPair ps)
        renderPair (k,v)   = show k ++ ": " ++ renderJValue v

renderJValue (JArray a) = "[" ++ values a ++ "]"
  where values [] = ""
        values vs = intercalate ", " (map renderJValue vs)</pre><br class="calibre48"/>
<a name="x_En" class="calibre27" id="x_En"></a><p class="docText">Good Haskell style involves separating pure code from code
    that performs I/O. Our <i class="docEmphasis">renderJValue</i>
    function has no interaction with the outside world, but we still need to
    be able to print a JValue:</p><pre class="calibre39">-- file: ch05/PutJSON.hs
putJValue :: JValue -&gt; IO ()
putJValue v = putStrLn (renderJValue v)</pre><br class="calibre48"/>
<a name="x_Fn" class="calibre27" id="x_Fn"></a><p class="docText">Printing a JSON value is now easy.</p><a name="x_Kn" class="calibre27" id="x_Kn"></a><p class="docText">Why should we separate the rendering code from the code
    that actually prints a value? This gives us flexibility. For instance, if
    we want to compress the data before writing it out and intermix rendering
    with printing, it would be much more difficult to adapt our code to that
    change in circumstances.</p><a name="x_Ln" class="calibre27" id="x_Ln"></a><p class="docText">This idea of separating pure from impure code is powerful,
    and it is pervasive in Haskell code. Several Haskell compression libraries
    exist, all of which have simple interfaces: a compression function accepts
    an uncompressed string and returns a compressed string. We can use
    function composition to render JSON data to a string, and then compress to
    another string, postponing any decision on how to actually display or
    transmit the data.</p>
<ul class="calibre18"></ul></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="middle" class="v3" height="5">
                        <img src="pixel.gif" alt="" border="0" class="calibre32"/>
                      </td>
                    </tr>
                    <tr class="calibre16">
                      <td valign="middle" class="v3">
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="sfbody1">
                          <tr class="calibre16">
                            <td class="v5"><span class="calibre33"> </span>
                   
                  <span class="calibre33">   </span>
             <span class="calibre33"> </span></td>
                          </tr>
                        </table>
                      </td>
                      <td class="v3"/>
                      <td valign="middle" class="v6"> 
           
          <span class="calibre33"><a target="_self" href="I_sect15_d1e13065.html" title="Previous section" class="calibre2"><img border="0" src="btn_prev.gif" alt="Previous section" id="btn_prev" class="calibre17"/></a></span>
				
				 
				
				<span class="calibre33"><a target="_self" href="I_sect15_d1e13228.html" title="Next section" class="calibre2"><img border="0" src="btn_next.gif" alt="Next section" id="btn_next" class="calibre17"/></a></span></td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="0" cellpadding="2" class="sfbody1">
                    <tr class="calibre16">
                      <td valign="top" class="v6">
                        <span class="calibre33"></span>
                      </td>
                    </tr>
                  </table>
                </div>
                <!--IP User 2-->
              </td>
            </tr>
          </table>
        </td>
        <td class="calibre7">
                         
                      </td>
      </tr>
      <tr class="calibre6">
        <td colspan="3" valign="bottom" class="calibre7">
          <br class="calibre20"/>
          <p class="v4"></p>
          <br class="calibre20"/>
        </td>
      </tr>
    </table>
  </div>

{% endraw %}

