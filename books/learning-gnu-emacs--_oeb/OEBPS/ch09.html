---
layout: page
title: "Learning GNU Emacs, 3rd Edition"
prev: OEBPS/ch08s05.html
next: OEBPS/ch09s02.html
book_path: books/learning-gnu-emacs--_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="calibre24"></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><div class="calibre24"></div><h1 class="title"><a id="gnu3-CHP-9" class="calibre1"></a>Chapter 9. Computer Language Support</h1></div></div></div><p class="copyright">As many programmers know, the task of programming usually breaks down
into a cycle of think-write-debug. If you have used Unix (or various
other operating systems) for programming, you have probably become
accustomed to using separate tools for each phase of the cycle, for
example, a text editor for writing, a compiler for compiling, and the
operating system itself for running programs. You would undoubtedly
find an environment much more productive if the boundaries between
the cycle phases—and the tools that support them—were
erased.</p><p class="copyright">Emacs provides considerable support for writing, running, and
debugging programs written in a wide variety of languages, and it
integrates this support into a smooth framework. You never have to
leave Emacs when developing programs, so you will find it easier to
concentrate on the actual programming task (i.e., the
"think" part of the cycle) because
you won't have to spend lots of time going from one
tool to another.</p><p class="copyright">When you write code, you can
<a id="gnu3-CHP-9-ITERM-2513" class="calibre2"></a>
         <a id="gnu3-CHP-9-ITERM-2514" class="calibre2"></a>use one of Emacs's
<span><em class="calibre7">programming language modes</em></span>; these turn Emacs
into a spiffy syntax-directed or language-sensitive editor that knows
about the syntax of the language. That makes it easier for you to
write code in a uniform, easy-to-read, customizable style. Language
modes exist for several different programming languages.</p><p class="copyright">Emacs also supports running and debugging programs. Shell mode (see
<a class="calibre2" href="ch05.html" title="Chapter 5. Emacs as a Work Environment">Chapter 5</a>) and multiple windows (see <a class="calibre2" href="ch04.html" title="Chapter 4. Using Buffers, Windows, and Frames">Chapter 4</a>) allow you to run your code while editing
it. Emacs has a powerful facility for interfacing to many compilers
and the Unix <span><strong class="calibre5">make</strong></span> command: Emacs can
interpret compilers' error messages and visit files
where errors occur at the appropriate line number. Indeed, many tools
(such as the Java build tool, <span><strong class="calibre5">ant</strong></span>)
include command-line options to format their output in an
Emacs-friendly way.</p><p class="copyright">In this chapter, we cover the features of language modes in general
such as compiling and debugging programs, comments, indentation, and
syntax highlighting. We also spend a bit of time upfront looking at
<a id="gnu3-CHP-9-ITERM-2515" class="calibre2"></a>the <span><strong class="calibre5">etags</strong></span> facility, which is a great help to
programmers who work on large, multifile projects. These features
apply to all language modes. We then delve into
Emacs's support for various languages, including C,
C++, Java, Perl, SQL, and Lisp.</p><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h1 class="title"><a id="gnu3-CHP-9-SECT-1" class="calibre1"></a>Emacs as an IDE</h1></div></div></div><p class="copyright">Emacs provides a <a id="gnu3-CHP-9-ITERM-2516" class="calibre2"></a>number of features that appeal to
developers. You can edit code quickly with font support and
auto-completion of function and variable names; you can compile the
program and even run a debugger all without leaving your
"editor." While you
don't have some of the graphical tools commonly
found in commercial integrated development environments (IDEs),
almost every other feature of those IDEs can be found in
Emacs—for every language you could imagine working in.</p><p class="copyright">Of course, there will always be occasions when you need to view your
documents without the bells and whistles some language modes attach.
You can always switch to plain text (<span><strong class="calibre5">M-x
text-mode</strong></span>) or, more to the point, fundamental mode
(<span><strong class="calibre5">M-x fundamental-mode</strong></span>).</p><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-9-SECT-1.1" class="calibre1"></a>Compiling and Debugging</h2></div></div></div><p class="copyright">As mentioned at the <a id="gnu3-CHP-9-ITERM-2517" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2518" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2519" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2520" class="calibre2"></a>beginning of this chapter,
Emacs's support for programmers does not end when
you are done writing the code. A typical strategy for using Emacs
when working on a large programming project is to log in, go to the
directory where your source files reside, and invoke Emacs on the
source files (e.g., <span><strong class="calibre5">emacs Makefile
myproj*.[ch]</strong></span> for C programmers). While you are editing
your code, you can compile it using the commands described
later—as you will see, you need not even worry about saving
your changes. You can also test your compiled code in a shell using
shell mode (see <a class="calibre2" href="ch05.html" title="Chapter 5. Emacs as a Work Environment">Chapter 5</a>). The bottom line is
that you should rarely—if ever—have to leave Emacs
throughout your session.</p><p class="copyright">Emacs provides an interface <a id="gnu3-CHP-9-ITERM-2521" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2522" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2523" class="calibre2"></a>to compilers and the Unix <span><strong class="calibre5">make</strong></span> utility that is more direct and powerful
than shell mode. At the heart of this facility is the command
<span><strong class="calibre5">M-x compile Enter</strong></span>. This command
causes a series of events to occur. First, it prompts you for a
compilation command. The default command is <span><strong class="calibre5">make -k</strong></span>,<sup class="calibre6">[<a id="gnu3-CHP-9-FNOTE-1" href="#ftn.gnu3-CHP-9-FNOTE-1" class="calibre2">1</a>]</sup> but if you type another command, that
new command becomes the default for subsequent invocations during
your Emacs session. You can change the default by setting the
variable <span><strong class="calibre5">compile-command</strong></span> in your
<span><em class="calibre7">.emacs</em></span> file. For example, to use the Java build
tool <span><strong class="calibre5">ant</strong></span> as your default compile
command, just add this line:</p><a id="I_9_tt435" class="calibre2"></a><pre class="programlisting">(setq 'compile-command "ant -emacs")</pre><p class="copyright">After you have typed the command, Emacs offers to save all unsaved
file buffers, thus relieving you of the responsibility of making sure
your changes have been saved. It then creates a buffer called
<code class="calibre21">*compilation*</code> and an associated window. It runs
the compilation command (as a subprocess, just like the shell in
shell mode), with output going to the
<code class="calibre21">*compilation*</code> buffer. While the command runs, the
minibuffer says <code class="calibre21">Compiling: run</code>; it says
<code class="calibre21">exit</code> when the compile job finishes.</p><p class="copyright">Now the fun begins. If the compilation resulted in an error, you can
type <span><strong class="calibre5">C-x `</strong></span> (for <span><strong class="calibre5">next-error</strong></span>; this is a backquote, not a single
quote). Emacs reads the first error message, figures out the file and
line number of the error, and visits the file at that line number.
After you have corrected the error, you can type <span><strong class="calibre5">C-x `</strong></span> again to visit subsequent error
locations. Each time you type <span><strong class="calibre5">C-x `</strong></span>,
Emacs scrolls the <code class="calibre21">*compilation*</code> window so that the
current error message appears at the top.</p><p class="copyright">To start at the first error message again, type <span><strong class="calibre5">C-x `</strong></span> with a prefix argument (i.e., <span><strong class="calibre5">C-u C-x `</strong></span>). A nice thing about <span><strong class="calibre5">C-x `</strong></span> is that you can use it as soon as an
error is encountered; you do not have to wait for the compilation to
finish.</p><p class="copyright">The mode of the <code class="calibre21">*compilation*</code> buffer (compilation
mode) supports a few other useful commands for navigating through the
error messages as summarized in <a class="calibre2" href="ch09.html#gnu3-CHP-9-TABLE-1" title="Table 9-1. Compilation mode commands">Table 9-1</a>.</p><div class="book"><a id="gnu3-CHP-9-TABLE-1" class="calibre2"></a><p class="title2"><b class="calibre25">Table 9-1. Compilation mode commands</b></p><div class="table-contents"><a id="gnu3-CHP-9-ITERM-2524" class="calibre2"></a><a id="gnu3-CHP-9-ITERM-2525" class="calibre2"></a><table summary="Compilation mode commands" class="calibre8"><colgroup class="calibre9"><col class="calibre10"/><col class="calibre10"/><col class="calibre10"/></colgroup><thead class="calibre11"><tr class="calibre12"><th class="calibre26">
                           <p class="copyright">
                              <span><strong class="calibre5">Keystrokes</strong></span>
                           </p>
                        </th><th class="calibre26">
                           <p class="copyright">
                              <span><strong class="calibre5">Command name</strong></span>
                           </p>
                        </th><th class="calibre27">
                           <p class="copyright">
                              <span><strong class="calibre5">Action</strong></span>
                           </p>
                        </th></tr></thead><tbody class="calibre15"><tr class="calibre12"><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">C-x `</strong></span>
                           </p>
                        </td><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">next-error</strong></span>
                           </p>
                        </td><td class="calibre29">
                           <p class="copyright">Move to the next error message and visit the corresponding source
code.</p>
                        </td></tr><tr class="calibre12"><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">M-n</strong></span>
                           </p>
                        </td><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">compilation-next-error</strong></span>
                           </p>
                        </td><td class="calibre29">
                           <p class="copyright">Move to the next error message.</p>
                        </td></tr><tr class="calibre12"><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">M-p</strong></span>
                           </p>
                        </td><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">compilation-previous-error</strong></span>
                           </p>
                        </td><td class="calibre29">
                           <p class="copyright">Move to the previous error message.</p>
                        </td></tr><tr class="calibre12"><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">C-c C-c</strong></span>
                           </p>
                        </td><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">compilation-goto-error</strong></span>
                           </p>
                        </td><td class="calibre29">
                           <p class="copyright">Visit the source code for the current error message.</p>
                        </td></tr><tr class="calibre12"><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">Space</strong></span>
                           </p>
                        </td><td class="calibre28">
                           <p class="copyright">
                              <span><strong class="calibre5">scroll-down</strong></span>
                           </p>
                        </td><td class="calibre29">
                           <p class="copyright">Scroll down one screen.</p>
                        </td></tr><tr class="calibre12"><td class="calibre30">
                           <p class="copyright">
                              <span><strong class="calibre5">Del</strong></span>
                           </p>
                        </td><td class="calibre30">
                           <p class="copyright">
                              <span><strong class="calibre5">scroll-up</strong></span>
                           </p>
                        </td><td class="calibre31">
                           <p class="copyright">Scroll up one screen.</p>
                        </td></tr></tbody></table></div></div><br class="book"/><p class="copyright">
               <span><strong class="calibre5">Space</strong></span> and <span><strong class="calibre5">Del</strong></span> are handy screen-scrolling commands found
in various read-only Emacs modes.</p><p class="copyright">Note that <span><strong class="calibre5">M-n</strong></span> and <span><strong class="calibre5">M-p</strong></span> do not visit the source code corresponding
to the error message; they simply allow you to move easily through
error messages that may take up more than one line each. However, you
can visit the source code from any error message by typing <span><strong class="calibre5">C-c C-c</strong></span>.</p><p class="copyright">How does Emacs interpret <a id="gnu3-CHP-9-ITERM-2526" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2527" class="calibre2"></a>the
error message? It uses the variable <span><strong class="calibre5">compilation-error-regexp-alist</strong></span>, which is a
list of regular expressions designed to match the error messages of a
wide variety of C and C++ compilers and the <span><strong class="calibre5">lint</strong></span> C code checking program.<sup class="calibre6">[<a id="gnu3-CHP-9-FNOTE-2" href="#ftn.gnu3-CHP-9-FNOTE-2" class="calibre2">2</a>]</sup> It should also work
with compilers for languages for which Emacs has language modes, such
as Java, Fortran, Ada, and Modula-2. Emacs tries to parse (analyze)
an error message with each of the regular expressions in the list
until it finds one that extracts the filename and line number where
the error occurred.</p><p class="copyright">There is a chance that the error <a id="gnu3-CHP-9-ITERM-2528" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2529" class="calibre2"></a>message parser won't
work with certain compilers, especially if you are using Emacs on a
non-Unix system. You can find out by trying <span><strong class="calibre5">M-x
compile</strong></span> on some code that you know contains an error; if
you type <span><strong class="calibre5">C-x `</strong></span>, and Emacs claims
that there are <code class="calibre21">no more errors</code>, the <span><strong class="calibre5">next-error</strong></span> feature does not work with your
compiler.</p><p class="copyright">If the parser doesn't work for you, you may want to
try adding a regular expression to <span><strong class="calibre5">compilation-error-regexp-alist</strong></span> that fits your
compiler's error message format.
We'll show you an example of this in <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a>.</p><p class="copyright">The <span><strong class="calibre5">compile</strong></span> package also
<a id="gnu3-CHP-9-ITERM-2530" class="calibre2"></a>includes
similar support for the Unix <span><strong class="calibre5">grep</strong></span>
(search files) command, thus effectively giving Emacs a multifile
search capability. If you type <span><strong class="calibre5">M-x
grep</strong></span>, you are prompted for arguments to send to <span><strong class="calibre5">grep</strong></span>—that is, a search pattern and
filename(s). Emacs runs <span><strong class="calibre5">grep</strong></span> with
the <span><strong class="calibre5">-n</strong></span> option, which tells it to
print filenames and line numbers of matching lines.<sup class="calibre6">[<a id="gnu3-CHP-9-FNOTE-3" href="#ftn.gnu3-CHP-9-FNOTE-3" class="calibre2">3</a>]</sup> The same
happens as with <span><strong class="calibre5">M-x compile</strong></span>; you can
type <span><strong class="calibre5">C-x `</strong></span> to have Emacs visit the
next matched line in its file.</p></div></div><div class="book"><br class="book"/><hr class="calibre4"/><div class="book"><p class="copyright"><sup class="calibre6">[<a id="ftn.gnu3-CHP-9-FNOTE-1" href="#gnu3-CHP-9-FNOTE-1" class="calibre2">1</a>] </sup>The <span><strong class="calibre5">-k</strong></span> option overrides <span><strong class="calibre5">make</strong></span>'s default of stopping
after a job returns an error. Instead, <span><strong class="calibre5">make</strong></span> continues on branches of the dependency
tree that do not depend on the branch where the error
occurred.</p></div><div class="book"><p class="copyright"><sup class="calibre6">[<a id="ftn.gnu3-CHP-9-FNOTE-2" href="#gnu3-CHP-9-FNOTE-2" class="calibre2">2</a>] </sup>Unfortunately, Emacs won't understand error
messages generated by <span><strong class="calibre5">make</strong></span> itself,
such as those due to syntax errors in your
<span><em class="calibre7">Makefile</em></span>.</p></div><div class="book"><p class="copyright"><sup class="calibre6">[<a id="ftn.gnu3-CHP-9-FNOTE-3" href="#gnu3-CHP-9-FNOTE-3" class="calibre2">3</a>] </sup>If <span><strong class="calibre5">grep -n</strong></span> is run on only one
file, it just prints line numbers; Emacs forces it to print the
filename as well in this case by appending the dummy file
<span><em class="calibre7">/dev/null</em></span> to the <span><strong class="calibre5">grep</strong></span> command.</p></div></div></div></div>

{% endraw %}

