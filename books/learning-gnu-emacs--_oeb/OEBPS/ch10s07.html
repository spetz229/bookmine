---
layout: page
title: "Learning GNU Emacs, 3rd Edition"
prev: OEBPS/ch10s06.html
next: OEBPS/ch10s08.html
book_path: books/learning-gnu-emacs--_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h1 class="title"><a id="gnu3-CHP-10-SECT-7" class="calibre1"></a>Starting Modes via Auto-Mode Customization</h1></div></div></div><p class="copyright">The tables in <a class="calibre2" href="apb.html" title="Appendix B. Emacs Lisp Packages">Appendix B</a> list
<a id="gnu3-CHP-10-ITERM-2731" class="calibre2"></a>
            <a id="gnu3-CHP-10-ITERM-2732" class="calibre2"></a>several major modes that are automatically
invoked when you visit a file whose name ends in the appropriate
suffix. Look for "suffix" in the
right-hand columns of the tables to see many of the associations
between filename suffixes and major modes that Emacs sets up by
default. These associations are contained in the special Emacs
variable <span><strong class="calibre5">auto-mode-alist</strong></span>. <span><strong class="calibre5">auto-mode-alist</strong></span> is a list of pairs
(<span><em class="calibre7">regexp</em></span> . <span><em class="calibre7">mode</em></span>), where
<span><em class="calibre7">regexp</em></span> is a regular expression (see
<a class="calibre2" href="ch03.html" title="Chapter 3. Search and Replace">Chapter 3</a> and <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a>)
and <span><em class="calibre7">mode</em></span> is the name of a function that invokes
a major mode. When Emacs visits a file, it searches this list (from
the beginning) for a regular expression that matches the
file's suffix. If it finds one, it runs the
associated mode function. Notice that <span><em class="calibre7">any</em></span> part
of a file's name—not just its suffix—can
actually be associated with a major mode.</p><p class="copyright">You can add your own associations to <span><strong class="calibre5">auto-mode-alist</strong></span>, although the syntax is weird
if you are not used to Lisp (see <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a> for
the gory details). If you are programming in the Ada language, and
your Ada compiler expects files with suffix
<span><em class="calibre7">.ada</em></span>, you can get Emacs to put your files in Ada
mode whenever you visit them by putting the following line in your
<span><em class="calibre7">.emacs</em></span> file:</p><a id="I_10_tt560" class="calibre2"></a><pre class="programlisting">(setq auto-mode-alist (cons '("\\.ada$" . ada-mode) auto-mode-alist))</pre><p class="copyright">Make sure you include the single quote after the term
<code class="calibre21">cons</code> and the dot between "<span><strong class="calibre5">\\</strong></span>.<code class="calibre21">ada$</code>" and <code class="calibre21">ada-mode</code>. The
notation '<code class="calibre21">(x . y)</code> is just Lisp syntax for
"make x and y a pair." The string
"<code class="calibre21">\\.ada$</code>" is a regular expression that means
"anything with <span><em class="calibre7">.ada</em></span> at the end
of it," that is, <code class="calibre21">$</code> matches the
end of the string (as opposed to the end of the line, which is what
it matches during regular expression search and replace). The entire
line of Lisp basically means "add the pair
<code class="calibre21">("\\.ada$", 'ada-mode)</code> to the front of the
auto-mode-alist." Note that, because Emacs searches
<span><strong class="calibre5">auto-mode-alist</strong></span> from the beginning
and stops when it finds a match, you can use the above <span><strong class="calibre5">cons</strong></span> construct to override existing mode
associations.<sup class="calibre6">[<a id="gnu3-CHP-10-FNOTE-3" href="#ftn.gnu3-CHP-10-FNOTE-3" class="calibre2">3</a>]</sup>
         </p><p class="copyright">As another example, let's say you save certain mail
messages in files whose names begin with <span><em class="calibre7">msg-</em></span>,
and you want to edit these files in text mode. Here is the way to do
it:</p><a id="I_10_tt561" class="calibre2"></a><pre class="programlisting">(setq auto-mode-alist (cons '("^msg-" . text-mode) auto-mode-alist))</pre><p class="copyright">Notice that in this case we are matching the
<span><em class="calibre7">beginning</em></span>, rather than the end, of the filename.
The regular expression operator (<span><strong class="calibre5">^</strong></span>)
means beginning of string, so the entire regular expression means
"anything beginning with msg-."</p><p class="copyright">Finally, if the name of a file you are editing does not match any of
the regular expressions in <span><strong class="calibre5">auto-mode-alist</strong></span>, Emacs puts it into the mode
whose name is the value of the variable <span><strong class="calibre5">default-major-mode</strong></span>. This mode is normally
fundamental mode, a basic mode without special functionality.
However, many people like to set their default mode to text mode,
accomplished by adding a line like this to
<span><em class="calibre7">.emacs</em></span>:</p><a id="I_10_tt562" class="calibre2"></a><pre class="programlisting">(setq default-major-mode 'text-mode)</pre><p class="copyright">Although we have covered many useful ways to customize Emacs in this
chapter, we have really only scratched the surface. To find out more,
turn to <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a> and find out about Lisp
programming, the key to getting Emacs to do just about anything you
want.</p><div class="book"><br class="book"/><hr class="calibre4"/><div class="book"><p class="copyright"><sup class="calibre6">[<a id="ftn.gnu3-CHP-10-FNOTE-3" href="#gnu3-CHP-10-FNOTE-3" class="calibre2">3</a>] </sup>Lisp programmers will understand that
there are other ways to add to <span><strong class="calibre5">auto-mode-alist</strong></span>, such as <span><strong class="calibre5">append</strong></span>.</p></div></div></div></div>

{% endraw %}

