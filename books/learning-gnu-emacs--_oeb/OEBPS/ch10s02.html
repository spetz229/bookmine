---
layout: page
title: "Learning GNU Emacs, 3rd Edition"
prev: OEBPS/ch10.html
next: OEBPS/ch10s03.html
book_path: books/learning-gnu-emacs--_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h1 class="title"><a id="gnu3-CHP-10-SECT-2" class="calibre1"></a>Modifying the .emacs File Directly</h1></div></div></div><p class="copyright">It's possible to customize Emacs in just about any
way you can imagine. Almost everything you see on the screen, every
command, keystroke, message, and so on, can be changed. As you may
imagine, most customizations involve the Emacs startup file
<span><em class="calibre7">.emacs</em></span>.</p><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-10-SECT-2.1" class="calibre1"></a>Custom Versus .emacs</h2></div></div></div><p class="copyright">The previous section <a id="gnu3-CHP-10-ITERM-2677" class="calibre2"></a>
               <a id="gnu3-CHP-10-ITERM-2678" class="calibre2"></a>discussed the interactive customization
tool, Custom, but left out some of the details on what happens any
time you "save for future
sessions." Custom places the configuration
information in your <span><em class="calibre7">.emacs</em></span> file. Some things
simply cannot be done through Custom (yet). Once you get familiar
with the types of statements that go into your
<span><em class="calibre7">.emacs</em></span> file, you may also just find it easier to
add a line or two directly.</p><p class="copyright">We should emphasize that using Custom or editing
<span><em class="calibre7">.emacs</em></span> by hand is not an either-or proposition.
When you save options via Custom, it adds its settings to the end of
your <span><em class="calibre7">.emacs</em></span> file and warns you not to edit them
by hand. Despite this prohibition, you can easily add your own
customizations to the beginning of that file. To illustrate this,
<a class="calibre2" href="ch10s02.html#gnu3-CHP-10-EX-1" title="Example 10-1. A .emacs file for Mac OS X with lines added by the user and by Custom">Example 10-1</a> shows a sample
<span><em class="calibre7">.emacs</em></span> file for Mac OS X that shows edits made
directly by the user as well as sections added by Custom (shown in
bold)</p><div class="book"><a id="gnu3-CHP-10-EX-1" class="calibre2"></a><p class="title2"><b class="calibre25">Example 10-1. A .emacs file for Mac OS X with lines added by the user and by Custom</b></p><div class="book"><pre class="programlisting">(setq mac-command-key-is-meta nil) 
(diary)
(setq load-path (cons "~/elisp" load-path))
(autoload 'html-helper-mode "html-helper-mode" "Yay HTML" t)
(setq html-helper-build-new-buffer t)
(setq auto-mode-alist (cons '("\.html$" . html-helper-mode) auto-mode-alist))
(setq-default indent-tabs-mode nil)
(setq-default tab-width 15)
(setq-default abbrev-mode t)
(read-abbrev-file "~/.abbrev_defs")
(setq save-abbrevs t)
(fset 'boldword
   [?\C-  escape ?f ?\C-x ?\C-x ?&lt; ?b ?&gt; ?\C-x ?\C-x ?&lt; ?/ ?b ?&gt;])
(fset 'italword
   [?\C-  escape ?f ?\C-x ?\C-x ?&lt; ?e ?m backspace backspace ?i ?&gt; 
   ?\C-x ?\C-x ?&lt; ?/ ?i ?&gt;])
(global-set-key "\C-x\C-kI" 'italword)
(setq shell-file-name "/bin/zsh")
(add-hook 'comint-output-filter-functions
   'comint-watch-for-password-prompt)
(custom-set-variables
  ;; custom-set-variables was added by Custom.
  ;; If you edit it by hand, you could mess it up, so be careful.
  ;; Your init file should contain only one such instance.
  ;; If there is more than one, they won't work right.
 '(global-font-lock-mode t nil (font-core))
 '(text-mode-hook (quote (turn-on-auto-fill text-mode-hook-identify))))
(custom-set-faces
  ;; custom-set-faces was added by Custom.
  ;; If you edit it by hand, you could mess it up, so be careful.
  ;; Your init file should contain only one such instance.
  ;; If there is more than one, they won't work right.
 )</pre></div></div><br class="book"/><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h3 class="title4"><a id="gnu3-CHP-10-SECT-2.1.1" class="calibre1"></a>Will the real .emacs please stand up?</h3></div></div></div><p class="copyright">You might have a bit of trouble finding the right
<span><em class="calibre7">.emacs</em></span> file to work with when
you're first starting out. Emacs actually looks for
a variety of startup files. In order, they are:</p><div class="book"><dl class="copyright"><dt class="book"><span>
                        <span><em class="calibre7">.emacs.elc</em></span>
                     </span></dt><dd class="calibre20"><p class="copyright">The byte-compiled Lisp version or your startup file. This is not
editable, but can make startup quicker if you have a big, complex
startup file.</p></dd><dt class="book"><span>
                        <span><em class="calibre7">.emacs.el</em></span>
                     </span></dt><dd class="calibre20"><p class="copyright">The more formal name for your startup file. You can use Lisp commands
to customize and initialize your entire Emacs environment.</p></dd><dt class="book"><span>
                        <span><em class="calibre7">.emacs</em></span>
                     </span></dt><dd class="calibre20"><p class="copyright">The common name for the startup file. Exactly like the
<span><em class="calibre7">.emacs.el</em></span> file, just without the
<span><em class="calibre7">.el</em></span> extension. Both are editable.</p></dd></dl></div><p class="copyright">As soon as Emacs finds one of these files, that's
it; then it's on to the next step in startup. You
can't have a <span><em class="calibre7">.emacs.elc</em></span> for the
big customizations and then a separate <span><em class="calibre7">.emacs</em></span>
for the last few. Sorry!</p><p class="copyright">For all you Emacs users on Microsoft Windows-based systems, you might
bump into a variation of this file that begins with an underscore ( _
) rather than a dot (. ). In the past, the Windows filesystem
required something before the first dot, so
<span><em class="calibre7">.emacs</em></span> was an invalid filename. Consequently,
<span><em class="calibre7">_emacs</em></span> was adopted. The same order and notes
about the <span><em class="calibre7">.elc</em></span> and <span><em class="calibre7">.el</em></span>
variants applies. In modern versions of Windows,
<span><em class="calibre7">.emacs</em></span> is a valid filename and the dot
variations take precedence over the underscore versions.</p></div></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-10-SECT-2.2" class="calibre1"></a>Basic .emacs Statements</h2></div></div></div><p class="copyright">Some changes require a <a id="gnu3-CHP-10-ITERM-2679" class="calibre2"></a>
               <a id="gnu3-CHP-10-ITERM-2680" class="calibre2"></a>knowledge
of Emacs Lisp programming (see <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a>);
others are simple enough without such knowledge. In this chapter, we
cover a variety of useful customizations that require no programming
knowledge. For now, however, you need to know this: every Emacs
<a id="gnu3-CHP-10-ITERM-2681" class="calibre2"></a>
               <a id="gnu3-CHP-10-ITERM-2682" class="calibre2"></a>command corresponds to a Lisp
<span><em class="calibre7">function</em></span>, which has the form:</p><a id="I_10_tt540" class="calibre2"></a><pre class="programlisting">(<em class="calibre7"><code class="calibre32">function-name arguments</code></em>
               <span><strong class="calibre5">)</strong></span></pre><p class="copyright">For example, if you want to move the cursor forward by a word, you
type <span><strong class="calibre5">M-f</strong></span>. What you are actually
doing is running the Lisp function:</p><a id="I_10_tt541" class="calibre2"></a><pre class="programlisting">(forward-word 1)</pre><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h3 class="title4"><a id="gnu3-CHP-10-SECT-2.2.1" class="calibre1"></a>Caveat editor</h3></div></div></div><p class="copyright">Two important comments concerning <span><em class="calibre7">.emacs</em></span> files
are in order. First, if you are inserting code into your
<span><em class="calibre7">.emacs</em></span> file, you may end up putting in something
that causes Emacs to fail or behave strangely. If this happens, you
can invoke Emacs without running your <span><em class="calibre7">.emacs</em></span>
file: simply invoke Emacs with the command-line option <span><strong class="calibre5">-q</strong></span>, and Emacs will not run your
<span><em class="calibre7">.emacs</em></span> file. (<a class="calibre2" href="ch13.html" title="Chapter 13. Platform-Specific Considerations">Chapter 13</a>
gives instructions for starting Emacs from the command-line on
Windows and Mac OS X.) You can then examine the file to figure out
what went wrong.</p><p class="copyright">The other comment is perhaps the most important piece of advice we
can give you concerning customizing your Emacs environment:
<span><em class="calibre7">steal mercilessly from other users</em></span>. In
particular, if you are dealing with a messy situation involving a
configuration problem or a subtle point about some specialized mode,
it is possible that some other user has solved the problem(s)
already. This is not dishonest or subversive in any way; rather, it
is <span><em class="calibre7">encouraged</em></span> by the makers of GNU Emacs, who
would rather software be shared than kept to oneself. Emacs even
provides an easy way to try out other users'
<span><em class="calibre7">.emacs</em></span> files: invoke Emacs with the option
<span><strong class="calibre5">-u</strong></span> 
                  <span><em class="calibre7">username</em></span>,
and <span><em class="calibre7">username</em></span>'s
<span><em class="calibre7">.emacs</em></span> file will run instead of yours. (Of
course, this works only with users on multiuser systems.)</p><p class="copyright">In fact, numerous example <span><em class="calibre7">.emacs</em></span> files are
available on the Web. (Check out "the very
unofficial" <span><em class="calibre7">.emacs</em></span> site,
<a class="calibre2" href="http://www.dotemacs.de/">http://www.dotemacs.de/</a>.)</p></div></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-10-SECT-2.3" class="calibre1"></a>A Sample .emacs File</h2></div></div></div><p class="copyright">Here's a quick example of a (very) simple
<span><em class="calibre7">.emacs</em></span> file:</p><a id="I_10_tt542" class="calibre2"></a><pre class="programlisting">;; Turn on font-lock mode to color text in certain modes 
(global-font-lock-mode t)

;; Make sure spaces are used when indenting code
(setq-default indent-tabs-mode nil)</pre><p class="copyright">The lines beginning with two
<a id="gnu3-CHP-10-ITERM-2683" class="calibre2"></a>
               <a id="gnu3-CHP-10-ITERM-2684" class="calibre2"></a>semicolons
are comments. They're meant to help you understand
what is being configured. Sometimes they also list possible values or
the previous value. You can say anything you want in a
comment—as long as it fits on one line. If you need to spill
over onto a second or third line, just begin each successive line
with ;;.</p><p class="copyright">Blank lines are ignored. Every other line (that's
not blank or a comment) is considered part of a Lisp program that is
executed to configure your Emacs session. In this example, we first
call the <span><strong class="calibre5">global-font-lock-mode</strong></span>
function with an argument of <span><strong class="calibre5">t</strong></span>
(true, or "on"). Next we make sure
that using the <span><strong class="calibre5">Tab</strong></span> key when writing
code doesn't actually insert a tab character but
uses spaces instead. (This is a good thing to do when writing
code—otherwise your code can come out very messy on systems
that use a different tab width.) We use the <span><strong class="calibre5">setq-default</strong></span> function to assign the <span><strong class="calibre5">indent-tabs-mode</strong></span> a <span><strong class="calibre5">nil</strong></span> (false or
"off") value. Using <span><strong class="calibre5">setq-default</strong></span> has the advantage of setting the
default value only—modes that choose to override this value may
still do so.</p><p class="copyright">If you're a seasoned Lisp programmer, you can do
anything you would normally have access to in Lisp. There are
certainly particular functions and variables you need to know about
to be effective, but it is just a Lisp program.</p><p class="copyright">For the rest of us, this file mostly consists of blocks of Lisp found
on the Internet or on a colleague's computer. You
edit in your personal values and hope it all works. Really. If you
use Custom to manage all of your configuration changes, you
don't even have to look at
<span><em class="calibre7">.emacs</em></span> unless you want to add your own lines at
the beginning of the file or look at what Custom has done.</p><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h3 class="title4"><a id="gnu3-CHP-10-SECT-2.3.1" class="calibre1"></a>Editing .emacs</h3></div></div></div><p class="copyright">The great thing about <a id="gnu3-CHP-10-ITERM-2685" class="calibre2"></a>
                  <a id="gnu3-CHP-10-ITERM-2686" class="calibre2"></a>configuring a text editor is that you can
use the editor itself to make the changes. You can visit the
<span><em class="calibre7">.emacs</em></span> file just as you would any other file.
The only thing to watch out for is where you are. Some folks put
backup copies of this file in strange places. You want to edit the
file that came from your home directory. If you're
unsure of where you are, you can use the full name
<span><em class="calibre7">~/.emacs</em></span> which Emacs translates to the proper
directory.</p><p class="copyright">Note also that <span><em class="calibre7">.emacs</em></span> is not required. If you
haven't had any reason to customize Emacs, it might
not exist. But you should feel free to create it when
you're ready to start tailoring your environment.
(Making your first change via Custom will also create
<span><em class="calibre7">.emacs</em></span> if it doesn't exist.)</p><p class="copyright">The best way to deal with this file really is to find an example file
and make small changes to it. Use those <span><strong class="calibre5">;;</strong></span> comments liberally. If
you're going to change a line in your
<span><em class="calibre7">.emacs</em></span> file, make a copy of it first:</p><a id="I_10_tt543" class="calibre2"></a><pre class="programlisting">;; Turn off font-lock
;;(global-font-lock-mode t)
(global-font-lock-mode nil)</pre><p class="copyright">That way you can easily get back to a known, working version of your
<span><em class="calibre7">.emacs</em></span> file. If things get really bad, just
start over. Rename your current <span><em class="calibre7">.emacs</em></span> file and
then copy and paste small chunks of it at a time.</p><p class="copyright">For changes required by modules and other packages, the documentation
for those modules usually includes example lines for insertion into
your <span><em class="calibre7">.emacs</em></span>. For example, the JDEE site includes
a sample <span><em class="calibre7">.emacs</em></span> file that can be used as-is or
appended to an existing file. (And if you want to get fancy, you can
leave the JDEE sample in a separate file and simply include a
<span><strong class="calibre5">load-file</strong></span> call from your
<span><em class="calibre7">.emacs</em></span> file. More on <span><strong class="calibre5">load-file</strong></span> can be found in the Elisp
documentation.)</p></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h3 class="title4"><a id="gnu3-CHP-10-SECT-2.3.2" class="calibre1"></a>Saving .emacs</h3></div></div></div><p class="copyright">You save <a id="gnu3-CHP-10-ITERM-2687" class="calibre2"></a> 
                  <a id="gnu3-CHP-10-ITERM-2688" class="calibre2"></a>your
<span><em class="calibre7">.emacs</em></span> just as you normally save any file. To
test any changes you've made, though,
you'll have to do one of two things. The sure-fire
method is to quit Emacs and launch it again. If everything comes up
the way you expected, you're good to go.</p><p class="copyright">You can also run <span><strong class="calibre5">M-x load-file</strong></span>.
You'll be prompted for the name of the file. Just
type in <span><strong class="calibre5">~/.emacs Enter</strong></span> and you
should be able to check your changes.</p><div class="warning"><h3 class="title6"><a id="gnu3-CHP-10-NOTE-17" class="calibre1"></a>Tip</h3><p class="calibre35">Be careful here: it's entirely possible that
something in your current session will interact with your new
<span><em class="calibre7">.emacs</em></span> file. For example, if you have already
set a default value for a variable, commenting out that line of your
<span><em class="calibre7">.emacs</em></span> file will not remove the value unless you
also remove the default value by hand. If you've got
a fairly simple configuration, though, you should be fine. Reloading
<span><em class="calibre7">.emacs</em></span> is certainly faster that restarting
Emacs!</p></div><p class="copyright">Either way, once you have verified that your configuration works the
way you want, you can forget about this file. Until you want to make
more changes, of course!</p></div></div></div></div>

{% endraw %}

