---
layout: page
title: "Learning GNU Emacs, 3rd Edition"
prev: OEBPS/ch09s07.html
next: OEBPS/ch10.html
book_path: books/learning-gnu-emacs--_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h1 class="title"><a id="gnu3-CHP-9-SECT-8" class="calibre1"></a>The Lisp Modes</h1></div></div></div><p class="copyright">Emacs has three Lisp modes, listed <a id="gnu3-CHP-9-ITERM-2614" class="calibre2"></a>
            <a id="gnu3-CHP-9-ITERM-2615" class="calibre2"></a>here by
their command names:</p><div class="book"><dl class="copyright"><dt class="book"><span>
                  <span><strong class="calibre5">emacs-lisp-mode</strong></span>
               </span></dt><dd class="calibre20"><p class="copyright">Used for editing Emacs Lisp code, as covered in <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a> (filename <span><em class="calibre7">.emacs</em></span> or
suffix <span><em class="calibre7">.el</em></span>).</p></dd><dt class="book"><span>
                  <span><strong class="calibre5">lisp-mode</strong></span>
               </span></dt><dd class="calibre20"><p class="copyright">Used for editing Lisp code intended for another Lisp system (suffix
<span><em class="calibre7">.l</em></span> or <span><em class="calibre7">.lisp</em></span>).</p></dd><dt class="book"><span>
                  <span><strong class="calibre5">lisp-interaction-mode</strong></span>
               </span></dt><dd class="calibre20"><p class="copyright">Used for editing and running Emacs Lisp code.</p></dd></dl></div><p class="copyright">All three modes have the same basic functionality; they differ only
in the support they give to running Lisp code.</p><p class="copyright">All three Lisp modes understand the basic syntax elements common to
all language modes. In addition, they have various commands that
apply to the more advanced syntactic concepts of S-expressions,
lists, and defuns. An <span><em class="calibre7">S-expression</em></span> (or syntactic
expression) is any syntactically correct Lisp expression, be it an
atom (number, symbol, variable, etc.), or parenthesized list.
<span><em class="calibre7">Lists</em></span> are special cases of S-expressions, and
<span><em class="calibre7">defuns</em></span> (function definitions) are special cases
of lists. Several commands deal with these syntactic concepts; you
will most likely become comfortable with a subset of them.</p><p class="copyright">
            <a class="calibre2" href="ch09s08.html#gnu3-CHP-9-TABLE-11" title="Table 9-11. S-expression commands">Table 9-11</a> shows the commands that
<a id="gnu3-CHP-9-ITERM-2616" class="calibre2"></a>
            <a id="gnu3-CHP-9-ITERM-2617" class="calibre2"></a>
            <a id="gnu3-CHP-9-ITERM-2618" class="calibre2"></a>handle S-expressions.</p><div class="book"><a id="gnu3-CHP-9-TABLE-11" class="calibre2"></a><p class="title2"><b class="calibre25">Table 9-11. S-expression commands</b></p><div class="table-contents"><table summary="S-expression commands" class="calibre8"><colgroup class="calibre9"><col class="calibre10"/><col class="calibre10"/><col class="calibre10"/></colgroup><thead class="calibre11"><tr class="calibre12"><th class="calibre26">
                        <p class="copyright">
                           <span><strong class="calibre5">Keystrokes</strong></span>
                        </p>
                     </th><th class="calibre26">
                        <p class="copyright">
                           <span><strong class="calibre5">Command name</strong></span>
                        </p>
                     </th><th class="calibre27">
                        <p class="copyright">
                           <span><strong class="calibre5">Action</strong></span>
                        </p>
                     </th></tr></thead><tbody class="calibre15"><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-b</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">backward-sexp</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move backward by one S-expression.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-f</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">forward-sexp</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move forward by one S-expression.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-t</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">transpose-sexps</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Transpose the two S-expressions around the cursor.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-@</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">mark-sexp</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Set mark to the end of the current S-expression; set the cursor to
the beginning.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-k</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">kill-sexp</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Delete the S-expression following the cursor.</p>
                     </td></tr><tr class="calibre12"><td class="calibre30">
                        <p class="copyright">(<span><em class="calibre7">none</em></span>)</p>
                     </td><td class="calibre30">
                        <p class="copyright">
                           <span><strong class="calibre5">backward-kill-sexp</strong></span>
                        </p>
                     </td><td class="calibre31">
                        <p class="copyright">Delete the S-expression preceding the cursor.</p>
                     </td></tr></tbody></table></div></div><br class="book"/><p class="copyright">Since an S-expression can be a wide variety of things, the actions of
commands that handle S-expressions are determined by where your
cursor is when you invoke them. If your cursor is on a <span><strong class="calibre5">(</strong></span> or on a space preceding one, the
S-expression in question is taken to be the list that starts with
that <span><strong class="calibre5">(</strong></span>. If your cursor is on some
other character such as a letter or number (or preceding whitespace),
the S-expression is taken to be an atom (symbol, variable, or
constant).</p><p class="copyright">For example, suppose your cursor is in this position:</p><a id="I_9_tt503" class="calibre2"></a><pre class="programlisting">(mary bob (dave (pete)) ed)</pre><p class="copyright">If you type <span><strong class="calibre5">C-M-f</strong></span>, the cursor moves
like this:</p><a id="I_9_tt504" class="calibre2"></a><pre class="programlisting">(mary bob (dave (pete)) ed)</pre><p class="copyright">That is, the cursor moves forward past the S-expression <span><strong class="calibre5">(dave (pete))</strong></span>, which is a list. However, say
your cursor is positioned like this:</p><a id="I_9_tt505" class="calibre2"></a><pre class="programlisting">(mary bob (dave (pete)) ed)</pre><p class="copyright">When you type <span><strong class="calibre5">C-M-f</strong></span>, it moves here:</p><a id="I_9_tt506" class="calibre2"></a><pre class="programlisting">(mary bob (dave (pete)) ed)</pre><p class="copyright">In this case, the S-expression is the atom <span><strong class="calibre5">bob</strong></span>.</p><p class="copyright">The commands moving in lists are shown in <a class="calibre2" href="ch09s08.html#gnu3-CHP-9-TABLE-12" title="Table 9-12. Commands for moving in lists">Table 9-12</a>.</p><div class="book"><a id="gnu3-CHP-9-TABLE-12" class="calibre2"></a><p class="title2"><b class="calibre25">Table 9-12. Commands for moving in lists</b></p><div class="table-contents"><table summary="Commands for moving in lists" class="calibre8"><colgroup class="calibre9"><col class="calibre10"/><col class="calibre10"/><col class="calibre10"/></colgroup><thead class="calibre11"><tr class="calibre12"><th class="calibre26">
                        <p class="copyright">
                           <span><strong class="calibre5">Keystrokes</strong></span>
                        </p>
                     </th><th class="calibre26">
                        <p class="copyright">
                           <span><strong class="calibre5">Command name</strong></span>
                        </p>
                     </th><th class="calibre27">
                        <p class="copyright">
                           <span><strong class="calibre5">Action</strong></span>
                        </p>
                     </th></tr></thead><tbody class="calibre15"><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-n</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">forward-list</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move forward by one list.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-p</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">backward-list</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move backward by one list.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-d</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">down-list</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move forward and down one parenthesis level.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">(<span><em class="calibre7">none</em></span>)</p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">up-list</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move forward out of one parenthesis level.</p>
                     </td></tr><tr class="calibre12"><td class="calibre30">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-u</strong></span>
                        </p>
                     </td><td class="calibre30">
                        <p class="copyright">
                           <span><strong class="calibre5">backward-up-list</strong></span>
                        </p>
                     </td><td class="calibre31">
                        <p class="copyright">Move backward out of one parenthesis level.</p>
                     </td></tr></tbody></table></div></div><br class="book"/><p class="copyright">As a mnemonic device, you can think of lists as analogous to lines
and S-expressions as analogous to characters; thus, <span><strong class="calibre5">C-n</strong></span> and <span><strong class="calibre5">C-p</strong></span>
appear in list motion commands, whereas <span><strong class="calibre5">C-f</strong></span> and <span><strong class="calibre5">C-b</strong></span>
appear in S-expression motion commands. <span><strong class="calibre5">C-M-n</strong></span> and <span><strong class="calibre5">C-M-p</strong></span> work similarly to <span><strong class="calibre5">C-M-f</strong></span> and <span><strong class="calibre5">C-M-b</strong></span>, respectively, except that you must
position the cursor so that there is a list in front or back of it to
move across—that is, there must be an opening or closing
parenthesis on, after, or before the cursor. If there is no
parenthesis, Emacs signals an error. For example, if your cursor is
positioned like this:</p><a id="I_9_tt507" class="calibre2"></a><pre class="programlisting">(fred bob (dave (pe<span>t</span>e)<span><em class="calibre7">)</em></span> ed)</pre><p class="copyright">and you type <span><strong class="calibre5">C-M-n</strong></span>, Emacs complains
with the message:</p><a id="I_9_tt508" class="calibre2"></a><pre class="programlisting">Containing expression ends prematurely</pre><p class="copyright">However, if your cursor is here:</p><a id="I_9_tt509" class="calibre2"></a><pre class="programlisting">(fred  b<span><em class="calibre7">o</em></span>b (dave (pete)) ed)</pre><p class="copyright">the "next list" is actually
<span><strong class="calibre5">(dave (pete))</strong></span>, and the cursor ends
up like this if you type <span><strong class="calibre5">C-M-n</strong></span>:</p><a id="I_9_tt510" class="calibre2"></a><pre class="programlisting">(fred bob (dave (pete)) ed)</pre><p class="copyright">The commands for moving up or down lists enable you to get inside or
outside them. For example, say your cursor is here:</p><a id="I_9_tt511" class="calibre2"></a><pre class="programlisting">            <span>(</span>fred bob (dave (pete)) ed)</pre><p class="copyright">typing <span><strong class="calibre5">C-M-d</strong></span> moves the cursor here:</p><a id="I_9_tt512" class="calibre2"></a><pre class="programlisting">(<span>f</span>red bob (dave (pete)) ed)</pre><p class="copyright">This is the result because <span><strong class="calibre5">fred</strong></span> is
the next level down after its enclosing list. Typing <span><strong class="calibre5">C-M-d</strong></span> again has this result:</p><a id="I_9_tt513" class="calibre2"></a><pre class="programlisting">(fred bob (<span>d</span>ave (pete)) ed)</pre><p class="copyright">You are now inside the list <span><strong class="calibre5">(dave
(pete))</strong></span>. At this point, typing <span><strong class="calibre5">C-M-u</strong></span> does the opposite of what <span><strong class="calibre5">C-M-d</strong></span> does: it moves the cursor back and
outside of the two lists. But if you type <span><strong class="calibre5">M-x
up-list Enter</strong></span>, you will move forward as well as out,
resulting in this:</p><a id="I_9_tt514" class="calibre2"></a><pre class="programlisting">(fred bob (dave (pete)) ed)</pre><p class="copyright">The commands for defuns listed in <a class="calibre2" href="ch09s08.html#gnu3-CHP-9-TABLE-13" title="Table 9-13. Commands for working with functions">Table 9-13</a> are
more straightforward.</p><div class="book"><a id="gnu3-CHP-9-TABLE-13" class="calibre2"></a><p class="title2"><b class="calibre25">Table 9-13. Commands for working with functions</b></p><div class="table-contents"><table summary="Commands for working with functions" class="calibre8"><colgroup class="calibre9"><col class="calibre10"/><col class="calibre10"/><col class="calibre10"/></colgroup><thead class="calibre11"><tr class="calibre12"><th class="calibre26">
                        <p class="copyright">
                           <span><strong class="calibre5">Keystrokes</strong></span>
                        </p>
                     </th><th class="calibre26">
                        <p class="copyright">
                           <span><strong class="calibre5">Command name</strong></span>
                        </p>
                     </th><th class="calibre27">
                        <p class="copyright">
                           <span><strong class="calibre5">Action</strong></span>
                        </p>
                     </th></tr></thead><tbody class="calibre15"><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-a</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">beginning-of-defun</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move to the beginning of the current function.</p>
                     </td></tr><tr class="calibre12"><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-e</strong></span>
                        </p>
                     </td><td class="calibre28">
                        <p class="copyright">
                           <span><strong class="calibre5">end-of-defun</strong></span>
                        </p>
                     </td><td class="calibre29">
                        <p class="copyright">Move to the end of the current function.</p>
                     </td></tr><tr class="calibre12"><td class="calibre30">
                        <p class="copyright">
                           <span><strong class="calibre5">C-M-h</strong></span>
                        </p>
                     </td><td class="calibre30">
                        <p class="copyright">
                           <span><strong class="calibre5">mark-defun</strong></span>
                        </p>
                     </td><td class="calibre31">
                        <p class="copyright">Put the cursor at the beginning of the function, put the mark at the
end.</p>
                     </td></tr></tbody></table></div></div><br class="book"/><p class="copyright">These commands work properly only when the <span><strong class="calibre5">(defun</strong></span> that starts the current function is at
the beginning of a line.</p><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-9-SECT-8.1" class="calibre1"></a>Indentation in Lisp Modes</h2></div></div></div><p class="copyright">The Lisp modes provide "flashing"
<a id="gnu3-CHP-9-ITERM-2619" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2620" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2621" class="calibre2"></a>of
matching left parentheses; if the matching parenthesis is outside of
the current window, the line it is on appears in the minibuffer. The
Lisp modes also provide indentation via the <span><strong class="calibre5">Tab</strong></span> key and <span><strong class="calibre5">C-j</strong></span> for <span><strong class="calibre5">newline-and-indent</strong></span> (except in Lisp interaction
mode, described later in this chapter). The indentation style
supported by the Lisp modes "knows"
a lot about Lisp keywords and list syntax; unfortunately, it is not
easily customized.<sup class="calibre6">[<a id="gnu3-CHP-9-FNOTE-12" href="#ftn.gnu3-CHP-9-FNOTE-12" class="calibre2">12</a>]</sup>
            </p><p class="copyright">Here is an example, a Lisp equivalent of the
"times" C function shown earlier in
the chapter, that illustrates the indentation style:</p><a id="I_9_tt515" class="calibre2"></a><pre class="programlisting">(defun times (x y)
  (let ((i 0)
        (result 0))
    (while (&lt; i x)
      (setq result (+ result y)
            i (1+ i)))
    result))</pre><p class="copyright">The basic indentation value is 2; this value is used whenever code on
the next line goes down a level in nesting. For example, the body of
the function, after the line containing <span><strong class="calibre5">defun</strong></span>, is indented by 2. The <span><strong class="calibre5">(while..</strong></span>. and <span><strong class="calibre5">result))</strong></span> lines are indented by 2 with respect
to the <span><strong class="calibre5">let</strong></span> because they are the body
of the block <span><strong class="calibre5">let</strong></span> introduces.</p><p class="copyright">Things like <span><strong class="calibre5">defun</strong></span>, <span><strong class="calibre5">let</strong></span>, and <span><strong class="calibre5">while</strong></span> are function calls, even though they act
like keywords. The indentation convention for function calls is that
if there are arguments on lines after the line where the function
name and first argument appear, the additional arguments line up with
the first one. In other words, this has the form:</p><a id="I_9_tt516" class="calibre2"></a><pre class="programlisting">(function-name arg1
               arg2
               arg3
               ...)</pre><p class="copyright">The multiple arguments to <span><strong class="calibre5">setq</strong></span> in
the preceding function provide another example of this.</p><p class="copyright">However, the indentation of the line <span><strong class="calibre5">(result
0)</strong></span> shows that something a bit different happens with lists
that are not function calls. The list in question is actually
<span><strong class="calibre5">((i 0) (result 0))</strong></span>, which is a list
with two elements (both of which are also lists). The indentation
style supported by the Lisp modes lines up these two elements.</p><p class="copyright">Even though keyword-like terms such as <span><strong class="calibre5">let</strong></span> and <span><strong class="calibre5">while</strong></span>
are actually function calls, the Lisp modes
"understand" these functions to the
extent that special indentation conventions are set up for them. For
example, if we were to put the condition for the while-loop on a
separate line and press <span><strong class="calibre5">Tab</strong></span> to
indent it properly, the result would be:</p><a id="I_9_tt517" class="calibre2"></a><pre class="programlisting">    (while 
        (&lt; i x)
      (setq result (+ result y)
            i (1+ i)))</pre><p class="copyright">Similar things happen with <span><strong class="calibre5">if</strong></span> and
<span><strong class="calibre5">cond</strong></span> control structures; <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a> contains properly indented examples.</p><p class="copyright">Another remark about indentation conventions: the Lisp modes are
geared toward a style in which multiple right parentheses are put on
the same line immediately following each other, instead of on
separate lines. For example, the line <span><strong class="calibre5">i (1+
i)))</strong></span> contains right parentheses that close off the
<span><strong class="calibre5">1+</strong></span> function, the <span><strong class="calibre5">setq</strong></span>, and the <span><strong class="calibre5">while</strong></span> respectively. If you prefer, you can put
your closing parentheses on separate lines, but if you press
<span><strong class="calibre5">Tab</strong></span> to indent them, they
won't line up properly with their matching open
parentheses; you have to indent them manually.</p><p class="copyright">In addition to the <span><strong class="calibre5">Tab</strong></span> and <span><strong class="calibre5">C-j</strong></span> commands for indentation, the Lisp modes
support the command <span><strong class="calibre5">C-M-q</strong></span> (for
<span><strong class="calibre5">indent-sexp</strong></span>), which indents every
line in the S-expression just following the cursor. You can use this
command, for example, to indent an entire function definition: just
put the cursor right before the <span><strong class="calibre5">defun</strong></span> and type <span><strong class="calibre5">C-M-q</strong></span>.</p></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-9-SECT-8.2" class="calibre1"></a>Comments in Lisp Modes</h2></div></div></div><p class="copyright">Comments in the Lisp modes are handled <a id="gnu3-CHP-9-ITERM-2622" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2623" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2624" class="calibre2"></a>by
the universal comment command <span><strong class="calibre5">M-;</strong></span>,
which indents out to <span><strong class="calibre5">comment-column</strong></span>
(or, if there is text at that column, one space past the last
character), inserts a semicolon, and puts the cursor just past it. If
you want a comment to occupy an entire line (or to start anywhere
other than at <span><strong class="calibre5">comment-column</strong></span>), you
must move to where you want the comment to start and type the
semicolon yourself. Note that if you press <span><strong class="calibre5">Tab</strong></span> on any line that contains only a comment,
the comment moves out to <span><strong class="calibre5">comment-column</strong></span>. To get around this, use two or
more semicolons; doing so causes <span><strong class="calibre5">Tab</strong></span>
to leave the comments where they are. The Lisp modes also support the
other comment commands discussed earlier in the chapter, including
<span><strong class="calibre5">M-j</strong></span> to extend a comment to another
line and <span><strong class="calibre5">M-x kill-comment Enter</strong></span> to
get rid of a single-line comment. These features are common to all
three Lisp modes; next, we discuss the features unique to each.</p></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-9-SECT-8.3" class="calibre1"></a>Emacs Lisp Mode Differences</h2></div></div></div><p class="copyright">Emacs Lisp mode was designed <a id="gnu3-CHP-9-ITERM-2625" class="calibre2"></a>to be
used with code meant to run within Emacs itself, so it facilitates
running the code you type. Lisp is an interpreted (as opposed to
purely compiled) language, so it is possible to blur the line between
the write and run/debug phases of Lisp programming; Emacs Lisp mode
takes some advantage of this opportunity, whereas Lisp interaction
mode goes even further, as we'll see later. In Emacs
Lisp mode, the command <span><strong class="calibre5">C-M-x</strong></span>
(<span><strong class="calibre5">eval-defun</strong></span>) picks up the function
definition around or after the cursor and evaluates it, meaning that
it parses the function and stores it so that Emacs
"knows" about the function when you
invoke it.</p><p class="copyright">Emacs Lisp mode also includes the command <span><strong class="calibre5">M-Tab</strong></span> (for <span><strong class="calibre5">lisp-complete-symbol</strong></span>),<sup class="calibre6">[<a id="gnu3-CHP-9-FNOTE-13" href="#ftn.gnu3-CHP-9-FNOTE-13" class="calibre2">13</a>]</sup> which performs
completion on the symbol (variable, function name, etc.) preceding
the cursor, as described in <a class="calibre2" href="ch14.html" title="Chapter 14. The Help System">Chapter 14</a>. Thus,
you can type the shortest unambiguous prefix for the symbol, followed
by <span><strong class="calibre5">M-Tab</strong></span>, and Emacs tries to
complete the symbol's name for you as far as it can.
If it completes the symbol name, you can go on with whatever you are
doing. If it doesn't, you haven't
provided an unambiguous prefix. You can type more characters (to
disambiguate further), or you can type <span><strong class="calibre5">M-Tab</strong></span> again, and a help window showing the
choices pops up. Then you can type more characters and complete the
symbol yourself, or you can try for completion again.</p></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-9-SECT-8.4" class="calibre1"></a>Lisp Mode Differences</h2></div></div></div><p class="copyright">Lisp mode (as opposed to Emacs Lisp mode) is meant for use with Lisp
processors other than the Emacs Lisp interpreter. Therefore it
includes a couple of commands for interfacing to an external Lisp
interpreter. The Lisp mode command <span><strong class="calibre5">C-c
C-z</strong></span> (<span><strong class="calibre5">run-lisp</strong></span>) starts up
your system's Lisp interpreter as a subprocess and
creates the <code class="calibre21">*lisp*</code> buffer (with an associated
window) for input and output.<sup class="calibre6">[<a id="gnu3-CHP-9-FNOTE-14" href="#ftn.gnu3-CHP-9-FNOTE-14" class="calibre2">14</a>]</sup> If a Lisp subprocess
already exists, <span><strong class="calibre5">C-c C-z</strong></span> uses it
rather than creating a second one. You can send function definitions
to the Lisp subprocess by putting the cursor anywhere within a
function's definition and using <span><strong class="calibre5">C-M-x</strong></span>, which in this case stands for <span><strong class="calibre5">lisp-send-defun</strong></span>. This procedure causes the
functions you define to become known to the Lisp interpreter so that
you can invoke them later.</p></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h2 class="title1"><a id="gnu3-CHP-9-SECT-8.5" class="calibre1"></a>Working with Lisp Fragments</h2></div></div></div><p class="copyright">Emacs Lisp mode is probably the best
<a id="gnu3-CHP-9-ITERM-2626" class="calibre2"></a>
               <a id="gnu3-CHP-9-ITERM-2627" class="calibre2"></a>thing to use if you are editing entire
files of Emacs Lisp code, for example, if you are programming your
own mode (as described in <a class="calibre2" href="ch11.html" title="Chapter 11. Emacs Lisp Programming">Chapter 11</a>) or
modifying an existing one. However, if you are editing
"little" pieces of Lisp code (for
example, making additions or modifications to your
<span><em class="calibre7">.emacs</em></span> file), Emacs has more powerful features
you can use that further blur the line between writing and running
code.</p><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h3 class="title4"><a id="gnu3-CHP-9-SECT-8.5.1" class="calibre1"></a>Commands for evaluating a line of Lisp</h3></div></div></div><p class="copyright">The first of these <a id="gnu3-CHP-9-ITERM-2628" class="calibre2"></a>is the command <span><strong class="calibre5">M-</strong></span>: (for <span><strong class="calibre5">eval-expression</strong></span>). This command enables you to
type a one-line Lisp expression of any kind in the minibuffer; the
expression is evaluated, and the result is printed in the minibuffer.
This is an excellent, quick way to check the values of Emacs
variables and to experiment with
"internal" Emacs functions that
aren't bound to keys or that require arguments. You
can use the symbol completion command <span><strong class="calibre5">M-Tab</strong></span> while you are using <span><strong class="calibre5">eval-expression</strong></span>.</p><p class="copyright">Unfortunately (or fortunately, depending on your point of view),
Emacs doesn't normally let you use <span><strong class="calibre5">eval-expression</strong></span>. If you try pressing <span><strong class="calibre5">M-</strong></span>:, you will see the message <code class="calibre21">loading
novice . . </code>.  in the minibuffer. Then a window pops up with
a message on the order of, "You
didn't really mean to type that, did
you?" You get three options: press <span><strong class="calibre5">Space</strong></span> to try the command only once, <span><strong class="calibre5">y</strong></span> to try it and enable it for future use with
no questions asked, or <span><strong class="calibre5">n</strong></span> to do
nothing.</p><p class="copyright">If you want to use <span><strong class="calibre5">eval-expression</strong></span>,
type <span><strong class="calibre5">y</strong></span>. This command actually
results in the following line being put in your
<span><em class="calibre7">.emacs</em></span> file:</p><a id="I_9_tt518" class="calibre2"></a><pre class="programlisting">(put 'eval-expression 'disabled nil)</pre><p class="copyright">If you are a knowledgeable Lisp programmer, you will understand that
this addition sets the property <span><strong class="calibre5">disabled</strong></span> of the symbol <span><strong class="calibre5">eval-expression</strong></span> to <span><strong class="calibre5">nil</strong></span>. In other words, Emacs considers certain
commands to be verboten to novice users and thus allows commands to
be disabled. If you want to skip this entire procedure and just use
<span><strong class="calibre5">eval-expression</strong></span>, simply put the
above line in your <span><em class="calibre7">.emacs</em></span> file yourself (make
sure you include the single quotes).</p><p class="copyright">Another feature that helps you exercise Emacs Lisp code is <span><strong class="calibre5">C-x C-e</strong></span> (for <span><strong class="calibre5">eval-last-sexp</strong></span>). This command runs the line of
Lisp that your cursor is on and prints its value in the minibuffer.
<span><strong class="calibre5">C-x C-e</strong></span> is handy for testing single
lines of code in an Emacs Lisp file.</p></div><div class="book" xml:lang="en"><div class="book"><div class="book"><div class="book"><h3 class="title4"><a id="gnu3-CHP-9-SECT-8.5.2" class="calibre1"></a>Using Lisp interaction mode</h3></div></div></div><p class="copyright">An even more powerful feature is <a id="gnu3-CHP-9-ITERM-2629" class="calibre2"></a>
                  <a id="gnu3-CHP-9-ITERM-2630" class="calibre2"></a>
                  <a id="gnu3-CHP-9-ITERM-2631" class="calibre2"></a>Lisp interaction mode. This is the mode the
default buffer <code class="calibre21">*scratch*</code> is in. Filenames with no
suffixes normally cause Emacs to go into Lisp interaction mode,
though you can change this using the variable <span><strong class="calibre5">auto-mode-alist</strong></span>, described earlier in this
chapter and in more detail in <a class="calibre2" href="ch10.html" title="Chapter 10. Customizing Emacs">Chapter 10</a>. You
can also put any buffer in Lisp interaction mode by typing <span><strong class="calibre5">M-x lisp-interaction-mode Enter</strong></span>; to create an
extra Lisp interaction buffer, just type <span><strong class="calibre5">C-x
b</strong></span> (for <span><strong class="calibre5">switch-to-buffer</strong></span>),
supply a buffer name, and put it in Lisp interaction mode.</p><p class="copyright">Lisp interaction mode is identical to Emacs Lisp mode except for one
important feature: <span><strong class="calibre5">C-j</strong></span> is bound to
the command <span><strong class="calibre5">eval-print-last-sexp</strong></span>.
This command takes the S-expression just before point, evaluates it,
and prints the result in the buffer. To get the usual <span><strong class="calibre5">newline-and-indent</strong></span> functionality attached to
<span><strong class="calibre5">C-j</strong></span> in other modes, you must press
<span><strong class="calibre5">Enter</strong></span>, followed by <span><strong class="calibre5">Tab</strong></span>.</p><p class="copyright">Remember that an S-expression is any syntactically valid expression
in Lisp. Therefore, you can use <span><strong class="calibre5">C-j</strong></span>
in Lisp interaction mode to check the values of variables, enter
function definitions, run functions, and so on. For example, if you
type <span><strong class="calibre5">auto-save-interval</strong></span> and press
<span><strong class="calibre5">C-j</strong></span>, the value of that variable (300
by default) appears. If you type a <span><strong class="calibre5">defun</strong></span> and press <span><strong class="calibre5">C-j</strong></span> after the last right parenthesis, Emacs
stores the function defined (for future invocation) and prints its
name; in this case, <span><strong class="calibre5">C-j</strong></span> is similar
to <span><strong class="calibre5">C-M-x</strong></span> (for <span><strong class="calibre5">eval-defun</strong></span>) except that the cursor must be
after (as opposed to before or in the middle of) the function being
defined. If you invoke a function, Emacs evaluates (runs) the
expression and responds with whatever value the function returns.</p><p class="copyright">
                  <span><strong class="calibre5">C-j</strong></span> in Lisp interaction mode gives
you an excellent way to play with, incrementally develop, and debug
Emacs Lisp code, and since Emacs Lisp is
"true" Lisp, it is even useful for
developing some bits of code for other Lisp systems.</p></div></div><div class="book"><br class="book"/><hr class="calibre4"/><div class="book"><p class="copyright"><sup class="calibre6">[<a id="ftn.gnu3-CHP-9-FNOTE-12" href="#gnu3-CHP-9-FNOTE-12" class="calibre2">12</a>] </sup>The indentation style is bound up
in the Emacs Lisp code for Lisp mode. If you are an experienced Lisp
hacker, you can examine the code for <span><strong class="calibre5">lisp-mode.el</strong></span> in the Emacs Lisp directory and
determine how to customize indentation the way you wish. A good place
to start looking is the function <span><strong class="calibre5">lisp-indent-line</strong></span>.</p></div><div class="book"><p class="copyright"><sup class="calibre6">[<a id="ftn.gnu3-CHP-9-FNOTE-13" href="#gnu3-CHP-9-FNOTE-13" class="calibre2">13</a>] </sup>This
key binding may not work on all platforms. If it is intercepted by
the operating system (as it is on Red Hat Linux), type <span><strong class="calibre5">Esc Tab</strong></span> instead (remember to release <span><strong class="calibre5">Esc</strong></span> before you press <span><strong class="calibre5">Tab</strong></span>).</p></div><div class="book"><p class="copyright"><sup class="calibre6">[<a id="ftn.gnu3-CHP-9-FNOTE-14" href="#gnu3-CHP-9-FNOTE-14" class="calibre2">14</a>] </sup>This Lisp mode command
(<span><strong class="calibre5">run-lisp</strong></span>) was designed to run with
the franz Lisp system on BSD Unix systems, though it should work with
other Lisp interpreters.</p></div></div></div></div>

{% endraw %}

