---
layout: page
title: "JavaScript Web Applications"
prev: OEBPS/ch13.html
next: OEBPS/ch13s03.html
book_path: books/alex-maccaw-javascript-web-applications-otx--_oeb/
---
{% include JB/setup %}
{% raw %}
<div>
<div class="book" title="Classes"><div class="book"><div class="book"><div class="book"><h1 class="title1"><a id="I_sect113_d1e13415" class="calibre1"></a>Classes</h1></div></div></div><p class="calibre3"><a id="index-724I745HA8F" class="calibre1"></a><a id="index-418G731VQ3B" class="calibre1"></a>JMVC’s controller and model inherit from its class helper:
    <code class="literal">$.Class</code>. To create a class, call <code class="literal">$.Class(NAME,
    [classProperties, ] instanceProperties])</code>:</p><pre class="screen">$.Class("Animal",{
  breathe : function(){
     console.log('breathe'); 
  }
});</pre><p class="calibre3">In the example above, instances of <code class="literal">Animal</code> have a
    <code class="literal">breathe()</code> method. We can create a new
    <code class="literal">Animal</code> instance and call <code class="literal">breathe()</code> on it:</p><pre class="screen">var man = new Animal();
man.breathe();</pre><p class="calibre3">If you want to create a subclass, simply call the base class with
    the subclass’s name and properties:</p><pre class="screen">Animal("Dog",{
  wag : function(){
    console.log('wag');
  }
})

var dog = new Dog;
dog.wag();
dog.breathe();</pre><div class="book" title="Instantiation"><div class="book"><div class="book"><div class="book"><h2 class="title3"><a id="id2941948" class="calibre12"></a>Instantiation</h2></div></div></div><p class="calibre3"><a id="I_indexterm13_d1e13462" class="calibre1"></a><a id="I_indexterm13_d1e13469" class="calibre1"></a><a id="I_indexterm13_d1e13476" class="calibre1"></a>When a new class instance is created, it calls the class’s
      <code class="literal">init</code> method with the arguments passed
      to the constructor function:</p><pre class="screen">$.Class('Person',{
  init : function(name){
    this.name = name;
  },

  speak : function(){
    return "I am " + this.name + ".";
  }
});

var payal = new Person("Payal");
assertEqual( payal.speak() ,  'I am Payal.' );</pre></div><div class="book" title="Calling Base Methods"><div class="book"><div class="book"><div class="book"><h2 class="title3"><a id="id2942008" class="calibre12"></a>Calling Base Methods</h2></div></div></div><p class="calibre3"><a id="I_indexterm13_d1e13491" class="calibre1"></a><a id="I_indexterm13_d1e13498" class="calibre1"></a>Call base methods with <code class="literal">this._super</code>. The following overwrites
      <code class="literal">person</code> to provide a <span class="calibre1">more
      “classy”</span> greeting:</p><pre class="screen">Person("ClassyPerson", {
  speak : function(){
    return "Salutations, " + this._super();
  }
});

var fancypants = new ClassyPerson("Mr. Fancy");
assertEquals( fancypants.speak() , 'Salutations, I am Mr. Fancy.')</pre></div><div class="book" title="Proxies"><div class="book"><div class="book"><div class="book"><h2 class="title3"><a id="id2942067" class="calibre12"></a>Proxies</h2></div></div></div><p class="calibre3"><a id="I_indexterm13_d1e13521" class="calibre1"></a><a id="I_indexterm13_d1e13528" class="calibre1"></a><a id="I_indexterm13_d1e13535" class="calibre1"></a>Class’ callback method returns a function that has “this”
      set appropriately, similar to <a class="ulink" href="http://api.jquery.com/jQuery.proxy/"><code class="literal">$.proxy</code></a>.
      The following creates a <code class="literal">Clicky</code> class
      that counts how many times it was clicked:</p><pre class="screen">$.Class("Clicky",{
  init : function(){
    this.clickCount = 0;
  },

  clicked: function(){
    this.clickCount++;
  },

  listen: function(el){
    el.click( this.callback('clicked') );
  }
})

var clicky = new Clicky();
clicky.listen( $('#foo') );
clicky.listen( $('#bar') ) ;</pre></div><div class="book" title="Static Inheritance"><div class="book"><div class="book"><div class="book"><h2 class="title3"><a id="id2942135" class="calibre12"></a>Static Inheritance</h2></div></div></div><p class="calibre3"><a id="I_indexterm13_d1e13554" class="calibre1"></a><a id="I_indexterm13_d1e13561" class="calibre1"></a><a id="I_indexterm13_d1e13568" class="calibre1"></a><a id="I_indexterm13_d1e13571" class="calibre1"></a>Class lets you define inheritable static properties and
      methods. The following allows <span class="calibre1">you to
      retrieve a <code class="literal">person</code> instance from the server by calling
      <code class="literal">Person.findOne(ID, </code></span><span class="calibre1"><code class="literal">success(person)
      )</code>. Success is called back with an instance of
      <code class="literal">Person</code>, which has the</span> <code class="literal">speak</code> method:</p><pre class="screen">$.Class("Person",{
  findOne : function(id, success){
    $.get('/person/'+id, function(attrs){
      success( new Person( attrs ) );
    },'json')
  }
},{
  init : function(attrs){
    $.extend(this, attrs)
  },
  speak : function(){
    return "I am "+this.name+".";
  }
})

Person.findOne(5, function(person){
  assertEqual( person.speak(), "I am Payal." );
})</pre></div><div class="book" title="Introspection"><div class="book"><div class="book"><div class="book"><h2 class="title3"><a id="id2942237" class="calibre12"></a>Introspection</h2></div></div></div><p class="calibre3"><a id="I_indexterm13_d1e13602" class="calibre1"></a><a id="I_indexterm13_d1e13609" class="calibre1"></a><a id="I_indexterm13_d1e13616" class="calibre1"></a>Class provides namespacing <a id="I_indexterm13_d1e13620" class="calibre1"></a>and access to the name of the class and namespace
      object:</p><pre class="screen">$.Class("Jupiter.Person");

Jupiter.Person.shortName; //-&gt; 'Person'
Jupiter.Person.fullName;  //-&gt; 'Jupiter.Person'
Jupiter.Person.namespace; //-&gt; Jupiter

var person = new Jupiter.Person();

person.Class.shortName; //-&gt; 'Person'</pre></div><div class="book" title="A Model Example"><div class="book"><div class="book"><div class="book"><h2 class="title3"><a id="id2942300" class="calibre12"></a>A Model Example</h2></div></div></div><p class="calibre3"><a id="I_indexterm13_d1e13632" class="calibre1"></a><a id="I_indexterm13_d1e13639" class="calibre1"></a><a id="I_indexterm13_d1e13646" class="calibre1"></a>Putting it all together, we can make a basic ORM-style
      model layer. Just by inheriting from <code class="literal">Model</code>, we can
      request data from REST services and get it back wrapped in instances of
      the inheriting <code class="literal">Model</code>:</p><pre class="screen">$.Class("Model",{
  findOne : function(id, success){
    $.get('/' + this.fullName.toLowerCase() + '/' + id, 
      this.callback(function(attrs){
         success( new this( attrs ) );
      })
    },'json')
  }
},{
  init : function(attrs){
    $.extend(this, attrs)
  }
})

Model("Person",{
  speak : function(){
    return "I am "+this.name+".";
  }
});

Person.findOne(5, function(person){
  alert( person.speak() );
});

Model("Task");

Task.findOne(7,function(task){
  alert(task.name);
});</pre><p class="calibre3">This is similar to how JavaScriptMVC’s model layer
      works.<a id="I_indexterm13_d1e13662" class="calibre1"></a><a id="I_indexterm13_d1e13663" class="calibre1"></a></p></div></div></div>

{% endraw %}

